<!DOCTYPE html><html xmlns:og="http://ogp.me/ns#"><head><meta charset="UTF-8" /><title>【解答例】Haskell 超入門 - Qiita</title><meta content="width=device-width,initial-scale=1" name="viewport" /><meta content="Haskell 超入門の解答例です。


フィボナッチ数


パターンマッチ

【問1】任意のn番目のフィボナッチ数を計算する関数fibをパターンマッチで実装してください。

初期値0, 1を基底部とします。


基底部

fib 0 = 0
fib 1 = 1



0, 1, 1, 2, 3, 5, ...よりfib 5について考えます。


具体例

fib 5 = 2 + 3 = fib 3 + fib 4



これをnで一般化すれば再帰部となります。


再..." name="description" /><meta content="summary" name="twitter:card" /><meta content="@Qiita" name="twitter:site" /><meta content="7shi" name="twitter:creator" /><meta content="【解答例】Haskell 超入門 - Qiita" property="og:title" /><meta content="article" property="og:type" /><meta content="http://qiita.com/7shi/items/0ece8c3394e1328267ed" property="og:url" /><meta content="http://cdn.qiita.com/assets/qiita-fb-2887e7b4aad86fd8c25cea84846f2236.png" property="og:image" /><meta content="[Haskell 超入門](http://qiita.com/7shi/items/145f1234f8ec2af923ef)の解答例です。

# フィボナッチ数

## パターンマッチ

【問1】任意のn番目のフィボナッチ数を計算す..." property="og:description" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><link rel="shortcut icon" type="image/x-icon" href="http://cdn.qiita.com/assets/favicons/public/production-4ff10c1e1e2b5fcb353ff9cafdd56c70.ico" /><link rel="apple-touch-icon" type="image/png" href="http://cdn.qiita.com/assets/favicons/public/apple-touch-icon-f9a6afad761ec2306e10db2736187c8b.png" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link rel="stylesheet" media="all" href="http://cdn.qiita.com/assets/public-e8d29e8ff1879118096f0f5877946857.min.css" /><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="Gzwg4+ZQFGhIDBm1GPkCUViodmltD//OtvwRPbsJnDxvi7Vfbp3Wu593gsPyuZsoKGnp1Iima9Oh+99+h0oWmQ==" /></head><body class="without-js" id=""><noscript><iframe height="0" src="//www.googletagmanager.com/ns.html?id=GTM-TBQWPN" style="display:none;visibility:hidden" width="0"></iframe></noscript><script>
  document.body.className = document.body.className.replace('without-js', '') + ' with-js';
  window.Qiita = {"asset_host":"cdn.qiita.com","TLD":"com","controller_path":"public/items","controller_action":"public/items#show","controller":"items","action":"show","env":"production","flash":{},"is_landing_page":false,"is_team_page":false,"root_domain":"qiita.com","variant":null,"config":{"mixpanel":{"career":"dd35af27e959781713d63fd7ca898a8d","per_team":"c0a2116368b33b44b5029ebd2cc9b094","public":"be87616606b0e26a87689099aab2c4e5","team":"b7c0342acba2dbc8742484d98788efb3"},"default_locale":"ja","locale":"en"},"team":null,"user":null,"GIT_BRANCH":null,"DEBUG":false};

</script>
<div class="headerContainer headerContainer-public" role="navigation"><div data-react-class="T.HeaderContainer" data-react-props="{&quot;user&quot;:null,&quot;team&quot;:null,&quot;news&quot;:{&quot;type&quot;:&quot;募集&quot;,&quot;content&quot;:&quot;QiitaやQiita:Teamを良くしたいエンジニア&quot;,&quot;url&quot;:&quot;http://increments.co.jp/jobs/engineers?utm_source=qiita\u0026utm_medium=header_news&quot;},&quot;initial_unread_count&quot;:null,&quot;siteid_image&quot;:&quot;http://cdn.qiita.com/siteid-reverse.png&quot;,&quot;is_team_page&quot;:false,&quot;on_team_setting&quot;:false,&quot;show_post_menu&quot;:true,&quot;show_search_menu&quot;:true,&quot;is_fluid&quot;:false,&quot;locale&quot;:&quot;en&quot;}"></div></div><div id="main"><ol class="itemBreadcrumbs" itemscope="" itemtype="http://schema.org/BreadcrumbList"><li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem"><a itemprop="item" href="/"><span itemprop="name">Qiita</span></a><meta content="1" itemprop="position" /></li><li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem"><a itemprop="item" href="/items"><span itemprop="name">Items</span></a><meta content="2" itemprop="position" /></li><li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem"><a itemprop="item" href="/tags/Haskell"><span itemprop="name">Haskell</span></a><meta content="3" itemprop="position" /></li></ol><article itemscope="" itemtype="http://schema.org/Article"><div class="ArticleMainHeader "><div class="container"></div><div class="container"><div class="row s-flex-align-center"><div class="col-sm-9"><h1 class="ArticleMainHeader__title">【解答例】Haskell 超入門</h1><ul class="TagList"><li class="TagList__item" data-count="1344"><a class="u-link-unstyled TagList__label" href="/tags/Haskell"><img alt="Haskell" class="TagList__icon" src="https://s3-ap-northeast-1.amazonaws.com/qiita-tag-image/373b3b0595a92712b2a45616f53dae97bc1a04e5/medium.jpg?1387913155" /><span>Haskell</span></a></li></ul></div><div class="col-sm-3"><div class="itemsShowHeaderStock"><ul class="list-unstyled itemsShowHeaderStock_statusList"><li><div class="itemsShowHeaderStock_count stock"><span class="fa fa-thumbs-up"></span><span class="js-likecount">14</span></div><div class="itemsShowHeaderStock_countText">Like</div></li><li><div class="itemsShowHeaderStock_count" content="0 UserComments" itemprop="interactionCount"><span class="fa fa-comment"></span>0</div><div class="itemsShowHeaderStock_countText">Comment</div></li></ul></div><div class="js-likebutton" data-props="{&quot;like_status&quot;:false,&quot;like_count&quot;:14,&quot;uuid&quot;:&quot;0ece8c3394e1328267ed&quot;,&quot;likable_type&quot;:&quot;Article&quot;,&quot;position&quot;:&quot;article-header&quot;}"></div><ul class="list-inline ArticleMainHeader__users"><li class="js-hovercard" data-hovercard-target-name="Reds"><a itemprop="url" href="/Reds"><img alt="Reds" class="thumb thumb--xs" src="https://0.gravatar.com/avatar/e751888e30cdc35253c1a3b241977adf?d=https%3A%2F%2Fidenticons.github.com%2F0e2f15414d97b8b642022be91ff105e0.png" /></a></li><li class="js-hovercard" data-hovercard-target-name="quenhulu"><a itemprop="url" href="/quenhulu"><img alt="quenhulu" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/14708/profile-images/1473683459" /></a></li><li class="js-hovercard" data-hovercard-target-name="kasumani"><a itemprop="url" href="/kasumani"><img alt="kasumani" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/3397/profile-images/1473683087" /></a></li><li class="js-hovercard" data-hovercard-target-name="HirotoKagotani"><a itemprop="url" href="/HirotoKagotani"><img alt="HirotoKagotani" class="thumb thumb--xs" src="https://secure.gravatar.com/avatar/0a3d8eae4760b65766757df2475e09df?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-140.png" /></a></li><li class="js-hovercard" data-hovercard-target-name="KAGE_MIKU"><a itemprop="url" href="/KAGE_MIKU"><img alt="KAGE_MIKU" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/35230/profile-images/1473686650" /></a></li><li class="js-hovercard" data-hovercard-target-name="nemo-kaz@github"><a itemprop="url" href="/nemo-kaz@github"><img alt="nemo-kaz@github" class="thumb thumb--xs" src="https://secure.gravatar.com/avatar/db1ed7e94efdcd3bad069628a35ed713?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-140.png" /></a></li><li class="js-hovercard" data-hovercard-target-name="yuu_abe"><a itemprop="url" href="/yuu_abe"><img alt="yuu_abe" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/65147/profile-images/1473696801" /></a></li><li class="js-hovercard" data-hovercard-target-name="Dai09"><a itemprop="url" href="/Dai09"><img alt="Dai09" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/66144/profile-images/1473697117" /></a></li><li class="js-hovercard" data-hovercard-target-name="RyotaMurohoshi"><a itemprop="url" href="/RyotaMurohoshi"><img alt="RyotaMurohoshi" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/4125/profile-images/1473683800" /></a></li><li class="js-hovercard" data-hovercard-target-name="senachi"><a itemprop="url" href="/senachi"><img alt="senachi" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/29152/profile-images/1473685299" /></a></li><li><a href="/7shi/items/0ece8c3394e1328267ed/likers"><span class="fa fa-ellipsis-h"></span></a></li></ul></div></div></div></div><div class="ArticleAsideHeader"><div class="container"><div class="u-flex u-space-between"><div class="u-flex u-flex-wrap"><div class="u-flex u-align-center s-pdv-5 u-flex-wrap"><div class="ArticleAsideHeader__author"><a href="/7shi"><img class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/32057/profile-images/1473685823" alt="1473685823" /></a> <a class="u-link-unstyled" href="/7shi">7shi</a> </div><div class="ArticleAsideHeader__date"><span data-toggle="tooltip" title="posted at 2014-08-31">Edited at <time datetime="2017-01-11T18:30:26+09:00" itemprop="dateModified">2017-01-11</time></span></div></div><div class="u-flex u-align-center s-pdv-5 mobile-hidden"><div class="ArticleAsideHeader__revision"> <a data-toggle="tooltip" title="Revisions" href="/7shi/items/0ece8c3394e1328267ed/revisions"><span class="fa fa-history"></span></a><span class="ArticleAsideHeader__revisionCount">42</span></div></div><div class="u-flex u-align-center s-pdv-5 mobile-hidden"></div></div><div class="u-flex u-align-center s-flex-justiry-between s-pdv-5 u-shrink-0"><div class="ArticleAsideHeader__stock"><div class="js-stockbutton" data-position="top" data-props="{&quot;stock_status&quot;:false}"></div></div><div class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#"><span class="fa fa-ellipsis-h fa-lg"></span></a><ul class="dropdown-menu dropdown-menu-right"><li class="dropdown__item--mobile"><a href="/7shi/items/0ece8c3394e1328267ed/revisions"><span class="fa fa-fw fa-history"></span> Revisions<span>(42)</span></a></li><li><a href="/7shi/items/0ece8c3394e1328267ed.md"><span class="fa fa-fw fa-file-text-o"></span> Show article as Markdown</a></li><li><a data-target=".js-report-form" data-toggle="modal" href="#"><span class="fa fa-fw fa-flag"></span> Report article</a></li></ul></div></div></div></div></div><div class="container"><div class="row" id="article-body-wrapper"><div class="col-sm-9"><section class="markdownContent markdownContent-headingEnabled js-task-list-container clearfix position-relative" id="item-0ece8c3394e1328267ed" itemprop="articleBody"><p><a href="http://qiita.com/7shi/items/145f1234f8ec2af923ef" id="reference-61dc42a18db021a7b774">Haskell 超入門</a>の解答例です。</p>

<h1>
<span id="フィボナッチ数" class="fragment"></span><a href="#%E3%83%95%E3%82%A3%E3%83%9C%E3%83%8A%E3%83%83%E3%83%81%E6%95%B0"><i class="fa fa-link"></i></a>フィボナッチ数</h1>

<h2>
<span id="パターンマッチ" class="fragment"></span><a href="#%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%E3%83%9E%E3%83%83%E3%83%81"><i class="fa fa-link"></i></a>パターンマッチ</h2>

<p>【問1】任意のn番目のフィボナッチ数を計算する関数<code>fib</code>をパターンマッチで実装してください。</p>

<p>初期値<code>0, 1</code>を基底部とします。</p>

<div class="code-frame" data-lang="hs">
<div class="code-lang"><span class="bold">基底部</span></div>
<div class="highlight"><pre>
<span class="nf">fib</span> <span class="mi">0</span> <span class="ow">=</span> <span class="mi">0</span>
<span class="nf">fib</span> <span class="mi">1</span> <span class="ow">=</span> <span class="mi">1</span>
</pre></div>
</div>

<p><code>0, 1, 1, 2, 3, 5, ...</code>より<code>fib 5</code>について考えます。</p>

<div class="code-frame" data-lang="hs">
<div class="code-lang"><span class="bold">具体例</span></div>
<div class="highlight"><pre>
<span class="nf">fib</span> <span class="mi">5</span> <span class="ow">=</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span> <span class="ow">=</span> <span class="n">fib</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">fib</span> <span class="mi">4</span>
</pre></div>
</div>

<p>これを<code>n</code>で一般化すれば再帰部となります。</p>

<div class="code-frame" data-lang="hs">
<div class="code-lang"><span class="bold">再帰部</span></div>
<div class="highlight"><pre>
<span class="nf">fib</span> <span class="n">n</span> <span class="ow">=</span> <span class="n">fib</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">fib</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>

<p>テストを追加して解答とします。</p>

<div class="code-frame" data-lang="hs">
<div class="code-lang"><span class="bold">解答</span></div>
<div class="highlight"><pre>
<span class="nf">fib</span> <span class="mi">0</span> <span class="ow">=</span> <span class="mi">0</span>
<span class="nf">fib</span> <span class="mi">1</span> <span class="ow">=</span> <span class="mi">1</span>
<span class="nf">fib</span> <span class="n">n</span> <span class="ow">=</span> <span class="n">fib</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">fib</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<span class="nf">main</span> <span class="ow">=</span> <span class="kr">do</span>
    <span class="n">print</span> <span class="o">$</span> <span class="n">fib</span> <span class="mi">6</span>
</pre></div>
</div>

<div class="code-frame" data-lang="text">
<div class="code-lang"><span class="bold">実行結果</span></div>
<div class="highlight"><pre>
8
</pre></div>
</div>

<h2>
<span id="ガード" class="fragment"></span><a href="#%E3%82%AC%E3%83%BC%E3%83%89"><i class="fa fa-link"></i></a>ガード</h2>

<p>【問2】問1で実装した関数をガードで書き直してください。</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="nf">fib</span> <span class="n">n</span>
    <span class="o">|</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span>    <span class="ow">=</span> <span class="mi">0</span>
    <span class="o">|</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span>    <span class="ow">=</span> <span class="mi">1</span>
    <span class="o">|</span> <span class="n">otherwise</span> <span class="ow">=</span> <span class="n">fib</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">fib</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<span class="nf">main</span> <span class="ow">=</span> <span class="kr">do</span>
    <span class="n">print</span> <span class="o">$</span> <span class="n">fib</span> <span class="mi">6</span>
</pre></div></div>

<div class="code-frame" data-lang="text">
<div class="code-lang"><span class="bold">実行結果</span></div>
<div class="highlight"><pre>
8
</pre></div>
</div>

<h2>
<span id="case---of" class="fragment"></span><a href="#case---of"><i class="fa fa-link"></i></a>case - of</h2>

<p>【問3】問1で実装した関数を<code>case</code>-<code>of</code>で書き直してください。無限ループを防ぐためガードを追加してください。</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="nf">fib</span> <span class="n">n</span> <span class="ow">=</span> <span class="kr">case</span> <span class="n">n</span> <span class="kr">of</span>
    <span class="mi">0</span> <span class="ow">-&gt;</span> <span class="mi">0</span>
    <span class="mi">1</span> <span class="ow">-&gt;</span> <span class="mi">1</span>
    <span class="kr">_</span> <span class="o">|</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">-&gt;</span> <span class="n">fib</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">fib</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<span class="nf">main</span> <span class="ow">=</span> <span class="kr">do</span>
    <span class="n">print</span> <span class="o">$</span> <span class="n">fib</span> <span class="mi">6</span>
</pre></div></div>

<div class="code-frame" data-lang="text">
<div class="code-lang"><span class="bold">実行結果</span></div>
<div class="highlight"><pre>
8
</pre></div>
</div>

<h1>
<span id="再実装" class="fragment"></span><a href="#%E5%86%8D%E5%AE%9F%E8%A3%85"><i class="fa fa-link"></i></a>再実装</h1>

<p>【問4】<code>sum</code>, <code>product</code>, <code>take</code>, <code>drop</code>, <code>reverse</code>と同じ機能の関数を再実装してください。関数名には<code>'</code>を付けてください。</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="nf">sum'</span> <span class="kt">[]</span>     <span class="ow">=</span> <span class="mi">0</span>
<span class="nf">sum'</span> <span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">xs</span><span class="p">)</span> <span class="ow">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">sum'</span> <span class="n">xs</span>

<span class="nf">product'</span> <span class="kt">[]</span>     <span class="ow">=</span> <span class="mi">1</span>
<span class="nf">product'</span> <span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">xs</span><span class="p">)</span> <span class="ow">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">product'</span> <span class="n">xs</span>

<span class="nf">take'</span> <span class="kr">_</span> <span class="kt">[]</span>        <span class="ow">=</span> <span class="kt">[]</span>
<span class="nf">take'</span> <span class="n">n</span> <span class="kr">_</span> <span class="o">|</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">=</span> <span class="kt">[]</span>
<span class="nf">take'</span> <span class="n">n</span> <span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">xs</span><span class="p">)</span>    <span class="ow">=</span> <span class="n">x</span> <span class="kt">:</span> <span class="n">take'</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="n">xs</span>

<span class="nf">drop'</span> <span class="kr">_</span> <span class="kt">[]</span>         <span class="ow">=</span> <span class="kt">[]</span>
<span class="nf">drop'</span> <span class="n">n</span> <span class="n">xs</span> <span class="o">|</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">=</span> <span class="n">xs</span>
<span class="nf">drop'</span> <span class="n">n</span> <span class="p">(</span><span class="kr">_</span><span class="kt">:</span><span class="n">xs</span><span class="p">)</span>     <span class="ow">=</span> <span class="n">drop'</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="n">xs</span>

<span class="nf">reverse'</span> <span class="kt">[]</span>     <span class="ow">=</span> <span class="kt">[]</span>
<span class="nf">reverse'</span> <span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">xs</span><span class="p">)</span> <span class="ow">=</span> <span class="n">reverse'</span> <span class="n">xs</span> <span class="o">++</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span>

<span class="nf">main</span> <span class="ow">=</span> <span class="kr">do</span>
    <span class="n">print</span> <span class="o">$</span> <span class="n">sum'</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">print</span> <span class="o">$</span> <span class="n">product'</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">print</span> <span class="o">$</span> <span class="n">take'</span> <span class="mi">2</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="n">print</span> <span class="o">$</span> <span class="n">drop'</span> <span class="mi">2</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="n">print</span> <span class="o">$</span> <span class="n">reverse'</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">5</span><span class="p">]</span>
</pre></div></div>

<div class="code-frame" data-lang="text">
<div class="code-lang"><span class="bold">実行結果</span></div>
<div class="highlight"><pre>
[1,2]
[3]
[5,4,3,2,1]
15
120
</pre></div>
</div>

<ul>
<li>リストが空になるまで順番にたどるため、基底部として<code>[]</code>を定義します。</li>
</ul>

<h2>
<span id="別解" class="fragment"></span><a href="#%E5%88%A5%E8%A7%A3"><i class="fa fa-link"></i></a>別解</h2>

<p>※ 勉強会で出た意見を反映した項目です。</p>

<p><code>++</code>を避けた実装です。本文では説明していませんが末尾再帰です。</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="nf">reverse'</span> <span class="n">xs</span> <span class="ow">=</span> <span class="n">f</span> <span class="n">xs</span> <span class="kt">[]</span>
    <span class="kr">where</span>
        <span class="n">f</span> <span class="kt">[]</span>     <span class="n">ys</span> <span class="ow">=</span> <span class="n">ys</span>
        <span class="n">f</span> <span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">xs</span><span class="p">)</span> <span class="n">ys</span> <span class="ow">=</span> <span class="n">f</span> <span class="n">xs</span> <span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">ys</span><span class="p">)</span>
</pre></div></div>

<h1>
<span id="階乗" class="fragment"></span><a href="#%E9%9A%8E%E4%B9%97"><i class="fa fa-link"></i></a>階乗</h1>

<p>【問5】<code>product</code>を使って<code>fact</code>（階乗）を実装してください。</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="nf">fact</span> <span class="n">n</span> <span class="ow">=</span> <span class="n">product</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">]</span>

<span class="nf">main</span> <span class="ow">=</span> <span class="kr">do</span>
    <span class="n">print</span> <span class="o">$</span> <span class="n">fact</span> <span class="mi">5</span>
</pre></div></div>

<div class="code-frame" data-lang="text">
<div class="code-lang"><span class="bold">実行結果</span></div>
<div class="highlight"><pre>
120
</pre></div>
</div>

<h1>
<span id="垂線の交点" class="fragment"></span><a href="#%E5%9E%82%E7%B7%9A%E3%81%AE%E4%BA%A4%E7%82%B9"><i class="fa fa-link"></i></a>垂線の交点</h1>

<p>【問6】点 $(p, q)$ から直線 $ax + by = c$ に下した垂線の交点を求める関数<code>perpPoint</code>を作成してください。aとbが両方ゼロになると解なしですが、チェックせずに無視してください。</p>

<div class="code-frame" data-lang="math"><div class="highlight"><pre>
ax + by = c \cdots (1)
</pre></div></div>

<p>(1)への垂線は</p>

<div class="code-frame" data-lang="math"><div class="highlight"><pre>
bx - ay = d \cdots (2)
</pre></div></div>

<p>(2)に $(p,q)$ を代入します。</p>

<div class="code-frame" data-lang="math"><div class="highlight"><pre>
d = bp - aq \cdots (3)
</pre></div></div>

<p>(1)と(2)の連立方程式を解いて(3)を代入すれば交点が求まります。</p>

<div class="code-frame" data-lang="math"><div class="highlight"><pre>
x=\frac{ac+bd}{a^2+b^2}, y=\frac{bc-ad}{a^2+b^2}
</pre></div></div>

<p>これをコード化します。</p>

<div class="code-frame" data-lang="hs">
<div class="code-lang"><span class="bold">解答</span></div>
<div class="highlight"><pre>
<span class="nf">perpPoint</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="ow">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="kr">where</span>
        <span class="n">x</span> <span class="ow">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">c</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">y</span> <span class="ow">=</span> <span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">c</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">d</span> <span class="ow">=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">p</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="n">q</span>

<span class="nf">main</span> <span class="ow">=</span> <span class="kr">do</span>
    <span class="n">print</span> <span class="o">$</span> <span class="n">perpPoint</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>

<div class="code-frame" data-lang="text">
<div class="code-lang"><span class="bold">実行結果</span></div>
<div class="highlight"><pre>
(1.0,1.0)
</pre></div>
</div>

<h1>
<span id="rot13" class="fragment"></span><a href="#rot13"><i class="fa fa-link"></i></a>ROT13</h1>

<p>【問7】<a href="http://ja.wikipedia.org/wiki/ROT13" rel="nofollow noopener" target="_blank">ROT13</a>を実装してください。</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="kr">import</span> <span class="nn">Data.Char</span>

<span class="nf">rot13ch</span> <span class="n">ch</span>
    <span class="o">|</span>  <span class="n">'A'</span> <span class="o">&lt;=</span> <span class="n">ch</span> <span class="o">&amp;&amp;</span> <span class="n">ch</span> <span class="o">&lt;=</span> <span class="n">'M'</span>
    <span class="o">||</span> <span class="n">'a'</span> <span class="o">&lt;=</span> <span class="n">ch</span> <span class="o">&amp;&amp;</span> <span class="n">ch</span> <span class="o">&lt;=</span> <span class="n">'m'</span> <span class="ow">=</span> <span class="n">chr</span> <span class="o">$</span> <span class="n">ord</span> <span class="n">ch</span> <span class="o">+</span> <span class="mi">13</span>
    <span class="o">|</span>  <span class="n">'N'</span> <span class="o">&lt;=</span> <span class="n">ch</span> <span class="o">&amp;&amp;</span> <span class="n">ch</span> <span class="o">&lt;=</span> <span class="n">'Z'</span>
    <span class="o">||</span> <span class="n">'n'</span> <span class="o">&lt;=</span> <span class="n">ch</span> <span class="o">&amp;&amp;</span> <span class="n">ch</span> <span class="o">&lt;=</span> <span class="n">'z'</span> <span class="ow">=</span> <span class="n">chr</span> <span class="o">$</span> <span class="n">ord</span> <span class="n">ch</span> <span class="o">-</span> <span class="mi">13</span>
    <span class="o">|</span> <span class="n">otherwise</span> <span class="ow">=</span> <span class="n">ch</span>

<span class="nf">rot13</span> <span class="s">""</span>     <span class="ow">=</span> <span class="s">""</span>
<span class="nf">rot13</span> <span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">xs</span><span class="p">)</span> <span class="ow">=</span> <span class="n">rot13ch</span> <span class="n">x</span> <span class="kt">:</span> <span class="n">rot13</span> <span class="n">xs</span>

<span class="nf">main</span> <span class="ow">=</span> <span class="kr">do</span>
    <span class="kr">let</span> <span class="n">hello13</span> <span class="ow">=</span> <span class="n">rot13</span> <span class="s">"Hello, World!"</span>
    <span class="n">print</span> <span class="n">hello13</span>
    <span class="n">print</span> <span class="o">$</span> <span class="n">rot13</span> <span class="n">hello13</span>
</pre></div></div>

<div class="code-frame" data-lang="text">
<div class="code-lang"><span class="bold">実行結果</span></div>
<div class="highlight"><pre>
"Uryyb, Jbeyq!"
"Hello, World!"
</pre></div>
</div>

<h1>
<span id="バブルソート" class="fragment"></span><a href="#%E3%83%90%E3%83%96%E3%83%AB%E3%82%BD%E3%83%BC%E3%83%88"><i class="fa fa-link"></i></a>バブルソート</h1>

<p>【問8】<a href="http://www.ics.kagoshima-u.ac.jp/%7Efuchida/edu/algorithm/sort-algorithm/bubble-sort.html" rel="nofollow noopener" target="_blank">バブルソート</a>を実装してください。</p>

<p>⇒ <a href="http://qiita.com/7shi/items/1e2a66bf8e8c7f0bd70f" id="reference-720af0fdda91d48ad471">詳細説明</a></p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="nf">bswap</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="ow">=</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span>
<span class="nf">bswap</span> <span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">xs</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span>     <span class="ow">=</span> <span class="n">y</span><span class="kt">:</span><span class="n">x</span><span class="kt">:</span><span class="n">ys</span>
    <span class="o">|</span> <span class="n">otherwise</span> <span class="ow">=</span> <span class="n">x</span><span class="kt">:</span><span class="n">y</span><span class="kt">:</span><span class="n">ys</span>
    <span class="kr">where</span>
        <span class="p">(</span><span class="n">y</span><span class="kt">:</span><span class="n">ys</span><span class="p">)</span> <span class="ow">=</span> <span class="n">bswap</span> <span class="n">xs</span>

<span class="nf">bsort</span> <span class="kt">[]</span> <span class="ow">=</span> <span class="kt">[]</span>
<span class="nf">bsort</span> <span class="n">xs</span> <span class="ow">=</span> <span class="n">y</span> <span class="kt">:</span> <span class="n">bsort</span> <span class="n">ys</span>
    <span class="kr">where</span>
        <span class="p">(</span><span class="n">y</span><span class="kt">:</span><span class="n">ys</span><span class="p">)</span> <span class="ow">=</span> <span class="n">bswap</span> <span class="n">xs</span>

<span class="nf">main</span> <span class="ow">=</span> <span class="kr">do</span>
    <span class="n">print</span> <span class="o">$</span> <span class="n">bswap</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">print</span> <span class="o">$</span> <span class="n">bsort</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">print</span> <span class="o">$</span> <span class="n">bsort</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">print</span> <span class="o">$</span> <span class="n">bsort</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</pre></div></div>

<div class="code-frame" data-lang="text">
<div class="code-lang"><span class="bold">実行結果</span></div>
<div class="highlight"><pre>
[1,4,3,2,5]
[1,2,3,4,5]
[1,2,3,4,5]
[1,2,3,4,5,6,7,8,9]
</pre></div>
</div>

<h1>
<span id="マージソート" class="fragment"></span><a href="#%E3%83%9E%E3%83%BC%E3%82%B8%E3%82%BD%E3%83%BC%E3%83%88"><i class="fa fa-link"></i></a>マージソート</h1>

<p>【問9】<a href="http://www.ics.kagoshima-u.ac.jp/%7Efuchida/edu/algorithm/sort-algorithm/merge-sort.html" rel="nofollow noopener" target="_blank">マージソート</a>を実装してください。</p>

<ul>
<li>ソートしながら2つのリストをマージする関数<code>merge</code>を作ります。</li>
<li>往路で分割、復路でマージを再帰関数で表現します。</li>
</ul>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="nf">merge</span> <span class="n">xs</span> <span class="kt">[]</span> <span class="ow">=</span> <span class="n">xs</span>
<span class="nf">merge</span> <span class="kt">[]</span> <span class="n">ys</span> <span class="ow">=</span> <span class="n">ys</span>
<span class="nf">merge</span> <span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">xs</span><span class="p">)</span> <span class="p">(</span><span class="n">y</span><span class="kt">:</span><span class="n">ys</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span>     <span class="ow">=</span> <span class="n">x</span> <span class="kt">:</span> <span class="n">merge</span> <span class="n">xs</span> <span class="p">(</span><span class="n">y</span><span class="kt">:</span><span class="n">ys</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">otherwise</span> <span class="ow">=</span> <span class="n">y</span> <span class="kt">:</span> <span class="n">merge</span> <span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">xs</span><span class="p">)</span> <span class="n">ys</span>

<span class="nf">msort</span> <span class="kt">[]</span>  <span class="ow">=</span> <span class="kt">[]</span>
<span class="nf">msort</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="ow">=</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span>
<span class="nf">msort</span> <span class="n">xs</span>  <span class="ow">=</span> <span class="n">merge</span> <span class="p">(</span><span class="n">msort</span> <span class="p">(</span><span class="n">take</span> <span class="n">h</span> <span class="n">xs</span><span class="p">))</span> <span class="p">(</span><span class="n">msort</span> <span class="p">(</span><span class="n">drop</span> <span class="n">h</span> <span class="n">xs</span><span class="p">))</span>
    <span class="kr">where</span>
        <span class="n">h</span> <span class="ow">=</span> <span class="p">(</span><span class="n">length</span> <span class="n">xs</span><span class="p">)</span> <span class="p">`</span><span class="n">div</span><span class="p">`</span> <span class="mi">2</span>

<span class="nf">main</span> <span class="ow">=</span> <span class="kr">do</span>
    <span class="n">print</span> <span class="o">$</span> <span class="n">msort</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</pre></div></div>

<div class="code-frame" data-lang="text">
<div class="code-lang"><span class="bold">実行結果</span></div>
<div class="highlight"><pre>
[1,2,3,4,5,6,7,8,9]
</pre></div>
</div>

<h1>
<span id="クイックソート" class="fragment"></span><a href="#%E3%82%AF%E3%82%A4%E3%83%83%E3%82%AF%E3%82%BD%E3%83%BC%E3%83%88"><i class="fa fa-link"></i></a>クイックソート</h1>

<p>【問10】処理の流れを説明してください。</p>

<p>リスト<code>[4, 6, 9, 8, 3, 5, 1, 7, 2]</code>をソートします。</p>

<p><code>(n:xs) = 4 : [6, 9, 8, 3, 5, 1, 7, 2]</code></p>

<p>リストの最初の要素<code>4</code>を基準に3つの部分に分けます。</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="nf">qsort</span> <span class="p">(</span><span class="n">n</span><span class="kt">:</span><span class="n">xs</span><span class="p">)</span> <span class="ow">=</span> <span class="n">qsort</span> <span class="n">lt</span> <span class="o">++</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">++</span> <span class="n">qsort</span> <span class="n">gteq</span>
    <span class="kr">where</span>
        <span class="n">lt</span>   <span class="ow">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">|</span> <span class="n">x</span> <span class="ow">&lt;-</span> <span class="n">xs</span><span class="p">,</span> <span class="n">x</span> <span class="o">&lt;</span>  <span class="n">n</span><span class="p">]</span>
        <span class="n">gteq</span> <span class="ow">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">|</span> <span class="n">x</span> <span class="ow">&lt;-</span> <span class="n">xs</span><span class="p">,</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="n">n</span><span class="p">]</span>
</pre></div></div>

<ul>
<li>4未満: <code>lt   = [x | x &lt;- xs, x &lt;  n]</code> → <code>[3, 1, 2]</code>
</li>
<li>4: <code>[x]</code> → <code>[4]</code>
</li>
<li>4以上: <code>gteq = [x | x &lt;- xs, x &gt;= n]</code> → <code>[6, 9, 8, 5, 7]</code>
</li>
</ul>

<p><code>lt</code>と<code>gteq</code>をソートして結合します。</p>

<div class="code-frame" data-lang="text">
<div class="code-lang"><span class="bold">実行イメージ</span></div>
<div class="highlight"><pre>
qsort [3, 1, 2] ++ [4] ++ qsort [6, 9, 8, 5, 7]
          ↓                           ↓
      [1, 2, 3] ++ [4] ++       [5, 6, 7, 8, 9]
          ↓                           ↓
      [1, 2, 3,     4,           5, 6, 7, 8, 9]
</pre></div>
</div>

<p><code>qsort [3, 1, 2]</code>と<code>qsort [6, 9, 8, 5, 7]</code>の内部では、同様の処理が繰り返されています。</p>

<h1>
<span id="直角三角形の三辺" class="fragment"></span><a href="#%E7%9B%B4%E8%A7%92%E4%B8%89%E8%A7%92%E5%BD%A2%E3%81%AE%E4%B8%89%E8%BE%BA"><i class="fa fa-link"></i></a>直角三角形の三辺</h1>

<p>【問11】三辺の長さが各20以下の整数で構成される直角三角形を列挙してください。並び順による重複を排除する必要はありません。</p>

<p>複数ソースのリスト内包表記に三平方の定理で条件付けします。</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="nf">main</span> <span class="ow">=</span> <span class="kr">do</span>
    <span class="n">print</span> <span class="p">[(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
          <span class="o">|</span> <span class="n">a</span> <span class="ow">&lt;-</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">20</span><span class="p">],</span> <span class="n">b</span> <span class="ow">&lt;-</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">20</span><span class="p">],</span> <span class="n">c</span> <span class="ow">&lt;-</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">20</span><span class="p">]</span>
          <span class="p">,</span> <span class="n">a</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">b</span> <span class="o">==</span> <span class="n">c</span> <span class="o">*</span> <span class="n">c</span>
          <span class="p">]</span>
</pre></div></div>

<div class="code-frame" data-lang="text">
<div class="code-lang"><span class="bold">実行結果</span></div>
<div class="highlight"><pre>
[(3,4,5),(4,3,5),(5,12,13),(6,8,10),(8,6,10),(8,15,17),(9,12,15),(12,5,13),(12,9,15),(12,16,20),(15,8,17),(16,12,20)]
</pre></div>
</div>

<h2>
<span id="重複排除" class="fragment"></span><a href="#%E9%87%8D%E8%A4%87%E6%8E%92%E9%99%A4"><i class="fa fa-link"></i></a>重複排除</h2>

<p>※ 勉強会で出た意見を反映した項目です。</p>

<p>条件 $a&lt;b$ を追加すれば並び順による重複が排除できます。</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="nf">main</span> <span class="ow">=</span> <span class="kr">do</span>
    <span class="n">print</span> <span class="p">[(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
          <span class="o">|</span> <span class="n">a</span> <span class="ow">&lt;-</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">20</span><span class="p">],</span> <span class="n">b</span> <span class="ow">&lt;-</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">20</span><span class="p">],</span> <span class="n">c</span> <span class="ow">&lt;-</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">20</span><span class="p">]</span>
          <span class="p">,</span> <span class="n">a</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">b</span> <span class="o">==</span> <span class="n">c</span> <span class="o">*</span> <span class="n">c</span><span class="p">,</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span>
          <span class="p">]</span>
</pre></div></div>

<div class="code-frame" data-lang="text">
<div class="code-lang"><span class="bold">実行結果</span></div>
<div class="highlight"><pre>
[(3,4,5),(5,12,13),(6,8,10),(8,15,17),(9,12,15),(12,16,20)]
</pre></div>
</div>

<p>条件で制限するのではなく、ソースから抜けば計算量が削減できます。</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="nf">main</span> <span class="ow">=</span> <span class="kr">do</span>
    <span class="n">print</span> <span class="p">[(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
          <span class="o">|</span> <span class="n">a</span> <span class="ow">&lt;-</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">20</span><span class="p">],</span> <span class="n">b</span> <span class="ow">&lt;-</span> <span class="p">[</span><span class="n">a</span><span class="o">..</span><span class="mi">20</span><span class="p">],</span> <span class="n">c</span> <span class="ow">&lt;-</span> <span class="p">[</span><span class="n">b</span><span class="o">..</span><span class="mi">20</span><span class="p">]</span>
          <span class="p">,</span> <span class="n">a</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">b</span> <span class="o">==</span> <span class="n">c</span> <span class="o">*</span> <span class="n">c</span>
          <span class="p">]</span>
</pre></div></div>

<div class="code-frame" data-lang="text">
<div class="code-lang"><span class="bold">実行結果</span></div>
<div class="highlight"><pre>
[(3,4,5),(5,12,13),(6,8,10),(8,15,17),(9,12,15),(12,16,20)]
</pre></div>
</div>
<div class="hidden"><form class="js-task-list-update" action="/7shi/items/0ece8c3394e1328267ed" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="_method" value="patch" /><input type="hidden" name="authenticity_token" value="AZxWiE9kh54cW7ePGoSN3DoiHYph+SBzLb+ZtzfsgZ91K8M0x6lFTcsgLPnwxBSlSuOCN4RQtG46uFf0C68LOg==" /><input type="hidden" name="updated_at_confirmation_in_unixtime" id="updated_at_confirmation_in_unixtime" value="1484127026" class="js-task-list-updated-at" /><textarea name="raw_body" id="raw_body" class="js-task-list-field">
[Haskell 超入門](http://qiita.com/7shi/items/145f1234f8ec2af923ef)の解答例です。

# フィボナッチ数

## パターンマッチ

【問1】任意のn番目のフィボナッチ数を計算する関数`fib`をパターンマッチで実装してください。

初期値`0, 1`を基底部とします。

```hs:基底部
fib 0 = 0
fib 1 = 1
```

`0, 1, 1, 2, 3, 5, ...`より`fib 5`について考えます。

```hs:具体例
fib 5 = 2 + 3 = fib 3 + fib 4
```

これを`n`で一般化すれば再帰部となります。

```hs:再帰部
fib n = fib (n - 2) + fib (n - 1)
```

テストを追加して解答とします。

```hs:解答
fib 0 = 0
fib 1 = 1
fib n = fib (n - 2) + fib (n - 1)

main = do
    print $ fib 6
```
```text:実行結果
8
```

## ガード

【問2】問1で実装した関数をガードで書き直してください。

```hs
fib n
    | n == 0    = 0
    | n == 1    = 1
    | otherwise = fib (n - 2) + fib (n - 1)

main = do
    print $ fib 6
```
```text:実行結果
8
```

## case - of

【問3】問1で実装した関数を`case`-`of`で書き直してください。無限ループを防ぐためガードを追加してください。

```hs
fib n = case n of
    0 -&gt; 0
    1 -&gt; 1
    _ | n &gt; 1 -&gt; fib (n - 2) + fib (n - 1)

main = do
    print $ fib 6
```
```text:実行結果
8
```

# 再実装

【問4】`sum`, `product`, `take`, `drop`, `reverse`と同じ機能の関数を再実装してください。関数名には`&#39;`を付けてください。

```hs
sum&#39; []     = 0
sum&#39; (x:xs) = x + sum&#39; xs

product&#39; []     = 1
product&#39; (x:xs) = x * product&#39; xs

take&#39; _ []        = []
take&#39; n _ | n &lt; 1 = []
take&#39; n (x:xs)    = x : take&#39; (n - 1) xs

drop&#39; _ []         = []
drop&#39; n xs | n &lt; 1 = xs
drop&#39; n (_:xs)     = drop&#39; (n - 1) xs

reverse&#39; []     = []
reverse&#39; (x:xs) = reverse&#39; xs ++ [x]

main = do
    print $ sum&#39; [1..5]
    print $ product&#39; [1..5]
    print $ take&#39; 2 [1, 2, 3]
    print $ drop&#39; 2 [1, 2, 3]
    print $ reverse&#39; [1..5]
```
```text:実行結果
[1,2]
[3]
[5,4,3,2,1]
15
120
```

* リストが空になるまで順番にたどるため、基底部として`[]`を定義します。

## 別解

※ 勉強会で出た意見を反映した項目です。

`++`を避けた実装です。本文では説明していませんが末尾再帰です。

```hs
reverse&#39; xs = f xs []
    where
        f []     ys = ys
        f (x:xs) ys = f xs (x:ys)
```

# 階乗

【問5】`product`を使って`fact`（階乗）を実装してください。

```hs
fact n = product [1..n]

main = do
    print $ fact 5
```
```text:実行結果
120
```

# 垂線の交点

【問6】点 $(p, q)$ から直線 $ax + by = c$ に下した垂線の交点を求める関数`perpPoint`を作成してください。aとbが両方ゼロになると解なしですが、チェックせずに無視してください。

```math
ax + by = c \cdots (1)
```

(1)への垂線は

```math
bx - ay = d \cdots (2)
```

(2)に $(p,q)$ を代入します。

```math
d = bp - aq \cdots (3)
```

(1)と(2)の連立方程式を解いて(3)を代入すれば交点が求まります。

```math
x=\frac{ac+bd}{a^2+b^2}, y=\frac{bc-ad}{a^2+b^2}
```

これをコード化します。

```hs:解答
perpPoint (p, q) (a, b, c) = (x, y)
    where
        x = (a * c + b * d) / (a * a + b * b)
        y = (b * c - a * d) / (a * a + b * b)
        d = b * p - a * q

main = do
    print $ perpPoint (0, 2) (1, -1, 0)
```
```text:実行結果
(1.0,1.0)
```

# ROT13

【問7】[ROT13](http://ja.wikipedia.org/wiki/ROT13)を実装してください。

```hs
import Data.Char

rot13ch ch
    |  &#39;A&#39; &lt;= ch &amp;&amp; ch &lt;= &#39;M&#39;
    || &#39;a&#39; &lt;= ch &amp;&amp; ch &lt;= &#39;m&#39; = chr $ ord ch + 13
    |  &#39;N&#39; &lt;= ch &amp;&amp; ch &lt;= &#39;Z&#39;
    || &#39;n&#39; &lt;= ch &amp;&amp; ch &lt;= &#39;z&#39; = chr $ ord ch - 13
    | otherwise = ch

rot13 &quot;&quot;     = &quot;&quot;
rot13 (x:xs) = rot13ch x : rot13 xs

main = do
    let hello13 = rot13 &quot;Hello, World!&quot;
    print hello13
    print $ rot13 hello13
```
```text:実行結果
&quot;Uryyb, Jbeyq!&quot;
&quot;Hello, World!&quot;
```

# バブルソート

【問8】[バブルソート](http://www.ics.kagoshima-u.ac.jp/~fuchida/edu/algorithm/sort-algorithm/bubble-sort.html)を実装してください。

⇒ [詳細説明](http://qiita.com/7shi/items/1e2a66bf8e8c7f0bd70f)

```hs
bswap [x] = [x]
bswap (x:xs)
    | x &gt; y     = y:x:ys
    | otherwise = x:y:ys
    where
        (y:ys) = bswap xs

bsort [] = []
bsort xs = y : bsort ys
    where
        (y:ys) = bswap xs

main = do
    print $ bswap [4, 3, 1, 5, 2]
    print $ bsort [4, 3, 1, 5, 2]
    print $ bsort [5, 4, 3, 2, 1]
    print $ bsort [4, 6, 9, 8, 3, 5, 1, 7, 2]
```
```text:実行結果
[1,4,3,2,5]
[1,2,3,4,5]
[1,2,3,4,5]
[1,2,3,4,5,6,7,8,9]
```

# マージソート

【問9】[マージソート](http://www.ics.kagoshima-u.ac.jp/~fuchida/edu/algorithm/sort-algorithm/merge-sort.html)を実装してください。

* ソートしながら2つのリストをマージする関数`merge`を作ります。
* 往路で分割、復路でマージを再帰関数で表現します。

```hs
merge xs [] = xs
merge [] ys = ys
merge (x:xs) (y:ys)
    | x &lt; y     = x : merge xs (y:ys)
    | otherwise = y : merge (x:xs) ys

msort []  = []
msort [x] = [x]
msort xs  = merge (msort (take h xs)) (msort (drop h xs))
    where
        h = (length xs) `div` 2

main = do
    print $ msort [4, 6, 9, 8, 3, 5, 1, 7, 2]
```
```text:実行結果
[1,2,3,4,5,6,7,8,9]
```

# クイックソート

【問10】処理の流れを説明してください。

リスト`[4, 6, 9, 8, 3, 5, 1, 7, 2]`をソートします。

`(n:xs) = 4 : [6, 9, 8, 3, 5, 1, 7, 2]`

リストの最初の要素`4`を基準に3つの部分に分けます。

```hs
qsort (n:xs) = qsort lt ++ [n] ++ qsort gteq
    where
        lt   = [x | x &lt;- xs, x &lt;  n]
        gteq = [x | x &lt;- xs, x &gt;= n]
```

* 4未満: `lt   = [x | x &lt;- xs, x &lt;  n]` → `[3, 1, 2]`
* 4: `[x]` → `[4]`
* 4以上: `gteq = [x | x &lt;- xs, x &gt;= n]` → `[6, 9, 8, 5, 7]`

`lt`と`gteq`をソートして結合します。

```text:実行イメージ
qsort [3, 1, 2] ++ [4] ++ qsort [6, 9, 8, 5, 7]
          ↓                           ↓
      [1, 2, 3] ++ [4] ++       [5, 6, 7, 8, 9]
          ↓                           ↓
      [1, 2, 3,     4,           5, 6, 7, 8, 9]
```

`qsort [3, 1, 2]`と`qsort [6, 9, 8, 5, 7]`の内部では、同様の処理が繰り返されています。

# 直角三角形の三辺

【問11】三辺の長さが各20以下の整数で構成される直角三角形を列挙してください。並び順による重複を排除する必要はありません。

複数ソースのリスト内包表記に三平方の定理で条件付けします。

```hs
main = do
    print [(a, b, c)
          | a &lt;- [1..20], b &lt;- [1..20], c &lt;- [1..20]
          , a * a + b * b == c * c
          ]
```
```text:実行結果
[(3,4,5),(4,3,5),(5,12,13),(6,8,10),(8,6,10),(8,15,17),(9,12,15),(12,5,13),(12,9,15),(12,16,20),(15,8,17),(16,12,20)]
```

## 重複排除

※ 勉強会で出た意見を反映した項目です。

条件 $a&lt;b$ を追加すれば並び順による重複が排除できます。

```hs
main = do
    print [(a, b, c)
          | a &lt;- [1..20], b &lt;- [1..20], c &lt;- [1..20]
          , a * a + b * b == c * c, a &lt; b
          ]
```
```text:実行結果
[(3,4,5),(5,12,13),(6,8,10),(8,15,17),(9,12,15),(12,16,20)]
```

条件で制限するのではなく、ソースから抜けば計算量が削減できます。

```hs
main = do
    print [(a, b, c)
          | a &lt;- [1..20], b &lt;- [a..20], c &lt;- [b..20]
          , a * a + b * b == c * c
          ]
```
```text:実行結果
[(3,4,5),(5,12,13),(6,8,10),(8,15,17),(9,12,15),(12,16,20)]
```
</textarea><input type="submit" name="commit" value="Save changes" data-disable-with="Save changes" /></form></div></section></div><div class="col-sm-3"><div class="socialButtons"><div class="socialButtons_twitter"><a class="twitter-share-button" data-text="【解答例】Haskell 超入門 by @7shi on @Qiita" data-url="http://qiita.com/7shi/items/0ece8c3394e1328267ed" href="https://twitter.com/share">Tweet</a></div><div class="socialButtons_hatebu"><a class="hatena-bookmark-button" data-hatena-bookmark-layout="simple-balloon" data-hatena-bookmark-title="【解答例】Haskell 超入門" href="http://b.hatena.ne.jp/entry/http://qiita.com/7shi/items/0ece8c3394e1328267ed" title="Add to Hatena Bookmark"><img alt="Add to Hatena Bookmark" height="20" src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" style="border: none;" width="20" /></a><script async="async" charset="utf-8" src="https://b.st-hatena.com/js/bookmark_button.js" type="text/javascript"></script></div><div class="socialButtons_googlePlus"><div class="g-plusone" data-href="http://qiita.com/7shi/items/0ece8c3394e1328267ed" data-size="medium"></div></div><div class="socialButtons_facebook"><div class="fb-like" data-action="like" data-href="http://qiita.com/7shi/items/0ece8c3394e1328267ed" data-layout="button_count" data-share="false" data-show-faces="false"></div></div><div class="socialButtons_pocket"><a class="pocket-btn" data-lang="en" data-pocket-count="horizontal" data-pocket-label="pocket"></a></div></div><section class="itemsShowAuthorInfo" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><a href="/7shi"><img alt="" class="itemsShowAuthorInfo_userIcon" itemprop="image" src="https://qiita-image-store.s3.amazonaws.com/0/32057/profile-images/1473685823" /></a><div class="itemsShowAuthorInfo_profileStats"><strong class="itemsShowAuthorInfo_userName" itemprop="name"><a itemprop="url" href="/7shi">7shi</a></strong><div class="itemsShowAuthorInfo_contribution"><span class="itemsShowAuthorInfo_count">2539</span><span class="itemsShowAuthorInfo_unit">Contribution</span></div><div data-react-class="T.UserFollowButton" data-react-props="{&quot;url_name&quot;:&quot;7shi&quot;,&quot;initial_followed_by&quot;:false,&quot;size&quot;:&quot;btn-xs&quot;,&quot;position&quot;:&quot;author-info&quot;}"></div></div><section class="itemsShowAuthorPopularItems"><h5 class="itemsShowAuthorPopularItems_sectionTitle">Popular Posts</h5><ul class="itemsShowAuthorPopularItems_posts list-unstyled"><li itemscope="" itemtype="http://schema.org/Article"> <a itemprop="url" track="click" data-label="AuthorPopularItemsAtSidebar" href="/7shi/items/145f1234f8ec2af923ef">Haskell 超入門</a></li><li itemscope="" itemtype="http://schema.org/Article"> <a itemprop="url" track="click" data-label="AuthorPopularItemsAtSidebar" href="/7shi/items/547b6137d7a3c482fe68">モナド則がちょっと分かった？</a></li><li itemscope="" itemtype="http://schema.org/Article"> <a itemprop="url" track="click" data-label="AuthorPopularItemsAtSidebar" href="/7shi/items/cac7b3e9b90bf91b00cc">文字列で学ぶC++入門</a></li><li itemscope="" itemtype="http://schema.org/Article"> <a itemprop="url" track="click" data-label="AuthorPopularItemsAtSidebar" href="/7shi/items/85afd7bbd5d6c4115ad6">Haskell アクション 超入門</a></li><li itemscope="" itemtype="http://schema.org/Article"> <a itemprop="url" track="click" data-label="AuthorPopularItemsAtSidebar" href="/7shi/items/d1e5a0c22be6cf61d286">Haskell IDE Leksah 入門</a></li></ul></section></section><div class="scroll-chaser"><div class="google-adsense"><style>.test-text-responsible { width: 200px; height: 200px; }@media(min-width: 1200px) {  .test-text-responsible { width: 250px; height: 250px; }}@media(max-width: 979px) and (min-width: 768px) {  .test-text-responsible { width: 120px; height: 240px; }}@media(max-width: 767px) {  .test-text-responsible { width: 320px; height: 50px; }}</style><script async="" src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle test-text-responsible" data-ad-client="ca-pub-8127218772604357" data-ad-slot="3880091879" style="display:inline-block"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div><div data-react-class="T.Toc" data-react-props="{&quot;body&quot;:&quot;\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#%E3%83%95%E3%82%A3%E3%83%9C%E3%83%8A%E3%83%83%E3%83%81%E6%95%B0\&quot;\u003eフィボナッチ数\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%E3%83%9E%E3%83%83%E3%83%81\&quot;\u003eパターンマッチ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#%E3%82%AC%E3%83%BC%E3%83%89\&quot;\u003eガード\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#case---of\&quot;\u003ecase - of\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#%E5%86%8D%E5%AE%9F%E8%A3%85\&quot;\u003e再実装\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#%E5%88%A5%E8%A7%A3\&quot;\u003e別解\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#%E9%9A%8E%E4%B9%97\&quot;\u003e階乗\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#%E5%9E%82%E7%B7%9A%E3%81%AE%E4%BA%A4%E7%82%B9\&quot;\u003e垂線の交点\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#rot13\&quot;\u003eROT13\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#%E3%83%90%E3%83%96%E3%83%AB%E3%82%BD%E3%83%BC%E3%83%88\&quot;\u003eバブルソート\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#%E3%83%9E%E3%83%BC%E3%82%B8%E3%82%BD%E3%83%BC%E3%83%88\&quot;\u003eマージソート\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#%E3%82%AF%E3%82%A4%E3%83%83%E3%82%AF%E3%82%BD%E3%83%BC%E3%83%88\&quot;\u003eクイックソート\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#%E7%9B%B4%E8%A7%92%E4%B8%89%E8%A7%92%E5%BD%A2%E3%81%AE%E4%B8%89%E8%BE%BA\&quot;\u003e直角三角形の三辺\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#%E9%87%8D%E8%A4%87%E6%8E%92%E9%99%A4\&quot;\u003e重複排除\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n&quot;,&quot;wrapper&quot;:&quot;#article-body-wrapper&quot;}"></div></div></div><div class="row"><div class="col-sm-9"><div class="ArticleFooter__menu"><div class="s-flex-align-center"><div class="js-likebutton" data-props="{&quot;like_status&quot;:false,&quot;like_count&quot;:14,&quot;show_count&quot;:true,&quot;uuid&quot;:&quot;0ece8c3394e1328267ed&quot;,&quot;likable_type&quot;:&quot;Article&quot;,&quot;position&quot;:&quot;article-footer&quot;}"></div><div class="ArticleFooter__userList"><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="Reds"><a itemprop="url" href="/Reds"><img alt="Reds" class="thumb thumb--xs" src="https://0.gravatar.com/avatar/e751888e30cdc35253c1a3b241977adf?d=https%3A%2F%2Fidenticons.github.com%2F0e2f15414d97b8b642022be91ff105e0.png" /></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="quenhulu"><a itemprop="url" href="/quenhulu"><img alt="quenhulu" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/14708/profile-images/1473683459" /></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="kasumani"><a itemprop="url" href="/kasumani"><img alt="kasumani" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/3397/profile-images/1473683087" /></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="HirotoKagotani"><a itemprop="url" href="/HirotoKagotani"><img alt="HirotoKagotani" class="thumb thumb--xs" src="https://secure.gravatar.com/avatar/0a3d8eae4760b65766757df2475e09df?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-140.png" /></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="KAGE_MIKU"><a itemprop="url" href="/KAGE_MIKU"><img alt="KAGE_MIKU" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/35230/profile-images/1473686650" /></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="nemo-kaz@github"><a itemprop="url" href="/nemo-kaz@github"><img alt="nemo-kaz@github" class="thumb thumb--xs" src="https://secure.gravatar.com/avatar/db1ed7e94efdcd3bad069628a35ed713?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-140.png" /></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="yuu_abe"><a itemprop="url" href="/yuu_abe"><img alt="yuu_abe" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/65147/profile-images/1473696801" /></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="Dai09"><a itemprop="url" href="/Dai09"><img alt="Dai09" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/66144/profile-images/1473697117" /></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="RyotaMurohoshi"><a itemprop="url" href="/RyotaMurohoshi"><img alt="RyotaMurohoshi" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/4125/profile-images/1473683800" /></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="senachi"><a itemprop="url" href="/senachi"><img alt="senachi" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/29152/profile-images/1473685299" /></a></div></div><div class="ArticleFooter__user"><a href="/7shi/items/0ece8c3394e1328267ed/likers"><span class="fa fa-ellipsis-h"></span></a></div></div></div><div class="u-flex u-align-center"><div class="ArticleFooter__stock"><div class="js-stockbutton" data-position="footer_menu" data-props="{&quot;stock_status&quot;:false}"></div></div><div class="ArticleFooter__editRequest"><a class="u-link-no-underline" data-toggle="tooltip" title="You can propose improvements about the article to the author 💪" href="/drafts/0ece8c3394e1328267ed/edit"><span class="fa fa-send-o fa-lg"></span> <span>Edit request</span></a></div><div class="dropdown ArticleFooter__dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#"><span class="fa fa-ellipsis-h"></span></a><ul class="dropdown-menu dropdown-menu-right"><li><a href="/7shi/items/0ece8c3394e1328267ed.md"><span class="fa fa-fw fa-file-text-o"></span> Show article as Markdown</a></li><li><a data-target=".js-report-form" data-toggle="modal" href="#"><i class="fa fa-fw fa-flag"></i> Report article</a></li></ul></div></div></div><ul class="references js-referencesView"><li class="references_header"><i class="fa fa-fw fa-link"></i> Linked from these articles</li><li class="references_reference js-reference"><span>Linked from </span><a href="/7shi/items/145f1234f8ec2af923ef#_reference-761c9b41a1c50066148c"><img alt="" width="18" height="18" src="https://qiita-image-store.s3.amazonaws.com/0/32057/profile-images/1473685823" />Haskell 超入門</a><time class="references_datetime js-dateTimeView" datetime="2014-08-31T13:16:06+00:00">over 2 years ago</time></li><li class="references_reference js-reference"><span>Linked from </span><a href="/DUxCA/items/26e5a2a776537eaf8de3#_reference-bd238448fdd1e788fb05"><img alt="" width="18" height="18" src="https://qiita-image-store.s3.amazonaws.com/0/13484/profile-images/1473682852" />【解答例】PureScript超入門</a><time class="references_datetime js-dateTimeView" datetime="2015-08-03T20:27:45+00:00">over 1 year ago</time></li></ul><div class="itemsShowBody_articleColumnFooter"><div class="socialButtons"><div class="socialButtons_twitter"><a class="twitter-share-button" data-text="【解答例】Haskell 超入門 by @7shi on @Qiita" data-url="http://qiita.com/7shi/items/0ece8c3394e1328267ed" href="https://twitter.com/share">Tweet</a></div><div class="socialButtons_hatebu"><a class="hatena-bookmark-button" data-hatena-bookmark-layout="simple-balloon" data-hatena-bookmark-title="【解答例】Haskell 超入門" href="http://b.hatena.ne.jp/entry/http://qiita.com/7shi/items/0ece8c3394e1328267ed" title="Add to Hatena Bookmark"><img alt="Add to Hatena Bookmark" height="20" src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" style="border: none;" width="20" /></a><script async="async" charset="utf-8" src="https://b.st-hatena.com/js/bookmark_button.js" type="text/javascript"></script></div><div class="socialButtons_googlePlus"><div class="g-plusone" data-href="http://qiita.com/7shi/items/0ece8c3394e1328267ed" data-size="medium"></div></div><div class="socialButtons_facebook"><div class="fb-like" data-action="like" data-href="http://qiita.com/7shi/items/0ece8c3394e1328267ed" data-layout="button_count" data-share="false" data-show-faces="false"></div></div><div class="socialButtons_pocket"><a class="pocket-btn" data-lang="en" data-pocket-count="horizontal" data-pocket-label="pocket"></a></div></div></div><div class="itemsShowComment_wrapper" id="comments"><div data-react-class="T.CommentListContainer" data-react-props="{&quot;currentUser&quot;:null,&quot;initialComments&quot;:[],&quot;monthly_public_image_uploadable_size_limit&quot;:null,&quot;total_uploaded_public_image_size_in_current_month&quot;:null,&quot;item&quot;:{&quot;id&quot;:121856,&quot;uuid&quot;:&quot;0ece8c3394e1328267ed&quot;,&quot;suspended&quot;:false,&quot;secret&quot;:false},&quot;owner&quot;:{&quot;url_name&quot;:&quot;7shi&quot;},&quot;is_team&quot;:false,&quot;is_project&quot;:false,&quot;logged_in&quot;:false,&quot;polling&quot;:false,&quot;mention_candidates&quot;:[{&quot;id&quot;:32057,&quot;url_name&quot;:&quot;7shi&quot;,&quot;profile_image_url&quot;:&quot;https://qiita-image-store.s3.amazonaws.com/0/32057/profile-images/1473685823&quot;}]}">Comments Loading...</div></div></div></div></div></article><div class="js-report-form modal fade reportForm"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button name="button" type="submit" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title">Report article</h4></div><div class="modal-body"><form action="/reports" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="ZokQeHlSUTPds7d+15FS/LjHcQMIQxcwfX1ZhUu262ESPoXE8Z+T4ArILAg90cuFyAbuvu3qgy1qepfGd/VhxA==" /><input type="hidden" name="redirect_path" id="redirect_path" value="/7shi/items/0ece8c3394e1328267ed" /><input type="hidden" name="item_uuid" id="item_uuid" value="0ece8c3394e1328267ed" /><p>Help us understand the problem. What is going on with this item?</p><br /><div class="form-group"><ul class="list-unstyled"><li><label><input type="radio" name="report_type" id="report_type_spam" value="spam" required="required" /> It&#39;s spam </label></li><li><label><input type="radio" name="report_type" id="report_type_harassment" value="harassment" required="required" /> It&#39;s abusive or harmful </label></li><li><label><input type="radio" name="report_type" id="report_type_inappropriate_content" value="inappropriate_content" required="required" /> It contains inappropriate content </label></li></ul></div><div class="reportForm_submitButtonContainer"><button name="button" type="submit" class="btn btn-primary reportForm_submitButton"><i class="fa fa-send"></i> Submit</button></div></form></div></div></div></div><script id="js-item" type="application/json">{ "url": "http://qiita.com/7shi/items/0ece8c3394e1328267ed", "id": 121856, "uuid": "0ece8c3394e1328267ed" }</script><script class="js-user" type="application/json">{&quot;id&quot;:32057,&quot;url_name&quot;:&quot;7shi&quot;,&quot;profile_image_url&quot;:&quot;https://qiita-image-store.s3.amazonaws.com/0/32057/profile-images/1473685823&quot;}</script><script language="JavaScript" src="//cdn.bigmining.com/private/js/qiita_bigmining.js" type="text/javascript"></script></div><footer class="footer"><div class="footer_inner"><div class="footer_container"><ul class="footer_links-left"><li class="footer_link"><a class="footer_copyright" href="http://increments.co.jp">© 2011-2017 Increments Inc.</a></li><li class="footer_link"><a href="http://qiita.com/terms">Terms</a></li><li class="footer_link"><a href="http://qiita.com/privacy">Privacy</a></li><li class="footer_link"><a href="http://help.qiita.com">Help</a></li><li class="footer_link"><a href="https://increments.zendesk.com/anonymous_requests/new">Contact</a></li></ul><ul class="footer_links-right"><li class="footer_link"><a href="http://qiita.com/about">About</a></li><li class="footer_link"><a href="/users">Users</a></li><li class="footer_link"><a href="/tags">Tags</a></li><li class="footer_link"><a href="http://blog.qiita.com">Blog</a></li><li class="footer_link"><a href="http://qiita.com/api/v2/docs">API</a></li><li class="footer_link"><a href="https://teams.qiita.com/">Team</a></li><li class="footer_link"><a href="http://kobito.qiita.com">Kobito</a></li><li class="footer_link"><a class="js-public-form-feedback-link" data-target=".js-feedback-form" data-toggle="modal" href=""><i class="fa fa-heart"></i> Feedback <i class="fa fa-caret-down"></i></a></li></ul></div></div></footer><div class="js-feedback-form modal fade feedbackForm"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button name="button" type="submit" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title">Feedback</h4></div><div class="modal-body"><form class="js-feedback-form-form" action="/feedbacks" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="BAsLrYtt7BJDgPtPCBRn9TkJqIUkhVIIjLLRfMPVb5twvJ4RA6AuwZT7YDniVP6MScg3OMEsxhWbtR8//5blPg==" /><input type="hidden" name="redirect_path" id="redirect_path" value="/7shi/items/0ece8c3394e1328267ed" /><div class="form-group"><textarea name="feedback[message]" id="feedback_message" class="form-control js-feedback-form-text-area" placeholder="Please give us any feedback about Qiita." required="required" rows="5">
</textarea></div><div class="feedbackForm_submitButtonContainer"><button name="button" type="submit" class="btn btn-primary feedbackForm_submitButton"><i class="fa fa-send"></i> Submit</button><p class="feedbackForm_note">We don&#39;t reply to any feedback.<br />If you need help with Qiita, please send a support request from <a href="https://increments.zendesk.com/anonymous_requests/new">here</a>.</p></div><div style="position:fixed;top:-99999px;opacity:0.0001;"><input name="feedback[name]" type="text" /></div></form></div></div></div></div><script>// if (window.mixpanel instanceof Element) {
//   window.mixpanel = [];
// }
// (function(f,b){if(!b.__SV){var a,e,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" ");
// for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=f.createElement("script");a.type="text/javascript";a.async=!0;a.src="//cdn.mxpnl.com/libs/mixpanel-2.2.min.js";e=f.getElementsByTagName("script")[0];e.parentNode.insertBefore(a,e)}})(document,window.mixpanel||[]);</script><script src="http://cdn.qiita.com/assets/public-cdd058934ecada5328128c0b59af8de8.min.js"></script><script>
  (function () {
    var script = document.getElementsByTagName('script')[0];
    var load = function (src, id) {
      var el = document.createElement('script');
      el.async = true;
      el.src = src;
      el.id = id;
      script.parentNode.insertBefore(el, script);
    };
      // Optimizely
      load('//cdn.optimizely.com/js/52738645.js', 'optimizely-jssdk');
      // Google Analytics
      window._gaq = window._gaq || [];
      var isCareer = location.hostname.split('.')[0] == 'career';
      if (isCareer) {
        window._gaq.push(['_setAccount', 'UA-24675221-11']);
        window._gaq.push(['_setDomainName', 'qiita.com']);
      } else {
        window._gaq.push(['_setAccount', 'UA-24675221-1']);
      }
      window._gaq.push(['_setCustomVar', 1, 'logged_in', 'false', 2]);
      window._gaq.push(['_trackPageview']);
      var src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      load(src, 'google-analytics-jssdk');
    // Google Analytics - Universal Analytics
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-24675221-12', {
          
        });
        ga('set', 'dimension1', 'false');
        ga('set', 'dimension3', 'false');
      ga('require', 'displayfeatures');
      ga('set', 'forceSSL', true);
      ga('send', 'pageview');
    // Google Tag Manager
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-TBQWPN');
  })();
</script>
</body></html>