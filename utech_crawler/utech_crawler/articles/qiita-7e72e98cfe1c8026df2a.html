<!DOCTYPE html><html xmlns:og="http://ogp.me/ns#"><head><meta charset="UTF-8" /><title>GHC 拡張を使って直積っぽい型の表記とかしてみる - Qiita</title><meta content="width=device-width,initial-scale=1" name="viewport" /><meta content="型族とかよくわからないから少し勉強した．
※ GHC 7.8.1 から追加された機能を用いています．


直積

二つの集合 $A$, $B$ に対し，


A \times B = \{(a, b) \mid a \in A, b \in B\}


によって定義される集合を直積 (デカルト積，カルテシアン積) という．

例えば $ A = \{ 1, 2 \} $, $ B = \{ a, b, c \} $ とすると
$ A \times B = \{ (1, ..." name="description" /><meta content="summary" name="twitter:card" /><meta content="@Qiita" name="twitter:site" /><meta content="CyLomw" name="twitter:creator" /><meta content="GHC 拡張を使って直積っぽい型の表記とかしてみる - Qiita" property="og:title" /><meta content="article" property="og:type" /><meta content="http://qiita.com/CyLomw/items/7e72e98cfe1c8026df2a" property="og:url" /><meta content="http://cdn.qiita.com/assets/qiita-fb-2887e7b4aad86fd8c25cea84846f2236.png" property="og:image" /><meta content="型族とかよくわからないから少し勉強した．
※ GHC 7.8.1 から追加された機能を用いています．

# 直積

二つの集合 $A$, $B$ に対し，

```math
A \times B = \{(a, b) \mid a \..." property="og:description" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><link rel="shortcut icon" type="image/x-icon" href="http://cdn.qiita.com/assets/favicons/public/production-4ff10c1e1e2b5fcb353ff9cafdd56c70.ico" /><link rel="apple-touch-icon" type="image/png" href="http://cdn.qiita.com/assets/favicons/public/apple-touch-icon-f9a6afad761ec2306e10db2736187c8b.png" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link rel="stylesheet" media="all" href="http://cdn.qiita.com/assets/public-e8d29e8ff1879118096f0f5877946857.min.css" /><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="C2i7qQt39HrHM9hhY/Im5zLVxFpTphhX/HkqjrDNorBl6iDxkFnNMTjgbX0TB5i+UpLg6cRiQqDApyN1UcOsdg==" /></head><body class="without-js" id=""><noscript><iframe height="0" src="//www.googletagmanager.com/ns.html?id=GTM-TBQWPN" style="display:none;visibility:hidden" width="0"></iframe></noscript><script>
  document.body.className = document.body.className.replace('without-js', '') + ' with-js';
  window.Qiita = {"asset_host":"cdn.qiita.com","TLD":"com","controller_path":"public/items","controller_action":"public/items#show","controller":"items","action":"show","env":"production","flash":{},"is_landing_page":false,"is_team_page":false,"root_domain":"qiita.com","variant":null,"config":{"mixpanel":{"career":"dd35af27e959781713d63fd7ca898a8d","per_team":"c0a2116368b33b44b5029ebd2cc9b094","public":"be87616606b0e26a87689099aab2c4e5","team":"b7c0342acba2dbc8742484d98788efb3"},"default_locale":"ja","locale":"en"},"team":null,"user":null,"GIT_BRANCH":null,"DEBUG":false};

</script>
<div class="headerContainer headerContainer-public" role="navigation"><div data-react-class="T.HeaderContainer" data-react-props="{&quot;user&quot;:null,&quot;team&quot;:null,&quot;news&quot;:{&quot;type&quot;:&quot;Hot&quot;,&quot;content&quot;:&quot;Markdownによる情報共有サービス、Qiita:Team&quot;,&quot;url&quot;:&quot;https://teams.qiita.com?utm_source=qiita\u0026utm_medium=header_news&quot;},&quot;initial_unread_count&quot;:null,&quot;siteid_image&quot;:&quot;http://cdn.qiita.com/siteid-reverse.png&quot;,&quot;is_team_page&quot;:false,&quot;on_team_setting&quot;:false,&quot;show_post_menu&quot;:true,&quot;show_search_menu&quot;:true,&quot;is_fluid&quot;:false,&quot;locale&quot;:&quot;en&quot;}"></div></div><div id="main"><ol class="itemBreadcrumbs" itemscope="" itemtype="http://schema.org/BreadcrumbList"><li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem"><a itemprop="item" href="/"><span itemprop="name">Qiita</span></a><meta content="1" itemprop="position" /></li><li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem"><a itemprop="item" href="/items"><span itemprop="name">Items</span></a><meta content="2" itemprop="position" /></li><li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem"><a itemprop="item" href="/tags/Haskell"><span itemprop="name">Haskell</span></a><meta content="3" itemprop="position" /></li></ol><article itemscope="" itemtype="http://schema.org/Article"><div class="ArticleMainHeader "><div class="container"></div><div class="container"><div class="row s-flex-align-center"><div class="col-sm-9"><h1 class="ArticleMainHeader__title">GHC 拡張を使って直積っぽい型の表記とかしてみる</h1><ul class="TagList"><li class="TagList__item" data-count="1345"><a class="u-link-unstyled TagList__label" href="/tags/Haskell"><img alt="Haskell" class="TagList__icon" src="https://s3-ap-northeast-1.amazonaws.com/qiita-tag-image/373b3b0595a92712b2a45616f53dae97bc1a04e5/medium.jpg?1387913155" /><span>Haskell</span></a></li></ul></div><div class="col-sm-3"><div class="itemsShowHeaderStock"><ul class="list-unstyled itemsShowHeaderStock_statusList"><li><div class="itemsShowHeaderStock_count stock"><span class="fa fa-thumbs-up"></span><span class="js-likecount">17</span></div><div class="itemsShowHeaderStock_countText">Like</div></li><li><div class="itemsShowHeaderStock_count" content="1 UserComments" itemprop="interactionCount"><span class="fa fa-comment"></span>1</div><div class="itemsShowHeaderStock_countText">Comment</div></li></ul></div><div class="js-likebutton" data-props="{&quot;like_status&quot;:false,&quot;like_count&quot;:17,&quot;uuid&quot;:&quot;7e72e98cfe1c8026df2a&quot;,&quot;likable_type&quot;:&quot;Article&quot;,&quot;position&quot;:&quot;article-header&quot;}"></div><ul class="list-inline ArticleMainHeader__users"><li class="js-hovercard" data-hovercard-target-name="HirofumiYashima"><a itemprop="url" href="/HirofumiYashima"><img alt="HirofumiYashima" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/43487/profile-images/1473689546" /></a></li><li class="js-hovercard" data-hovercard-target-name="skonb"><a itemprop="url" href="/skonb"><img alt="skonb" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/15796/profile-images/1473681688" /></a></li><li class="js-hovercard" data-hovercard-target-name="JunKikuchi"><a itemprop="url" href="/JunKikuchi"><img alt="JunKikuchi" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/13181/profile-images/1473682708" /></a></li><li class="js-hovercard" data-hovercard-target-name="ynakayama"><a itemprop="url" href="/ynakayama"><img alt="ynakayama" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/38501/profile-images/1473687793" /></a></li><li class="js-hovercard" data-hovercard-target-name="7shi"><a itemprop="url" href="/7shi"><img alt="7shi" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/32057/profile-images/1473685823" /></a></li><li class="js-hovercard" data-hovercard-target-name="wint"><a itemprop="url" href="/wint"><img alt="wint" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/62934/profile-images/1473696116" /></a></li><li class="js-hovercard" data-hovercard-target-name="techno-tanoC"><a itemprop="url" href="/techno-tanoC"><img alt="techno-tanoC" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/49469/profile-images/1473691739" /></a></li><li class="js-hovercard" data-hovercard-target-name="ykominami"><a itemprop="url" href="/ykominami"><img alt="ykominami" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/4321/profile-images/1473756115" /></a></li><li class="js-hovercard" data-hovercard-target-name="gfngfn"><a itemprop="url" href="/gfngfn"><img alt="gfngfn" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/75927/profile-images/1473700310" /></a></li><li class="js-hovercard" data-hovercard-target-name="yanana"><a itemprop="url" href="/yanana"><img alt="yanana" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/15836/profile-images/1473681701" /></a></li><li><a href="/CyLomw/items/7e72e98cfe1c8026df2a/likers"><span class="fa fa-ellipsis-h"></span></a></li></ul></div></div></div></div><div class="ArticleAsideHeader"><div class="container"><div class="u-flex u-space-between"><div class="u-flex u-flex-wrap"><div class="u-flex u-align-center s-pdv-5 u-flex-wrap"><div class="ArticleAsideHeader__author"><a href="/CyLomw"><img class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/64300/profile-images/1473696539" alt="1473696539" /></a> <a class="u-link-unstyled" href="/CyLomw">CyLomw</a> </div><div class="ArticleAsideHeader__date"><span data-toggle="tooltip" title="posted at 2015-01-13">Edited at <time datetime="2015-01-22T10:52:46+09:00" itemprop="dateModified">2015-01-22</time></span></div></div><div class="u-flex u-align-center s-pdv-5 mobile-hidden"><div class="ArticleAsideHeader__revision"> <a data-toggle="tooltip" title="Revisions" href="/CyLomw/items/7e72e98cfe1c8026df2a/revisions"><span class="fa fa-history"></span></a><span class="ArticleAsideHeader__revisionCount">7</span></div></div><div class="u-flex u-align-center s-pdv-5 mobile-hidden"></div></div><div class="u-flex u-align-center s-flex-justiry-between s-pdv-5 u-shrink-0"><div class="ArticleAsideHeader__stock"><div class="js-stockbutton" data-position="top" data-props="{&quot;stock_status&quot;:false}"></div></div><div class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#"><span class="fa fa-ellipsis-h fa-lg"></span></a><ul class="dropdown-menu dropdown-menu-right"><li class="dropdown__item--mobile"><a href="/CyLomw/items/7e72e98cfe1c8026df2a/revisions"><span class="fa fa-fw fa-history"></span> Revisions<span>(7)</span></a></li><li><a href="/CyLomw/items/7e72e98cfe1c8026df2a.md"><span class="fa fa-fw fa-file-text-o"></span> Show article as Markdown</a></li><li><a data-target=".js-report-form" data-toggle="modal" href="#"><span class="fa fa-fw fa-flag"></span> Report article</a></li></ul></div></div></div></div></div><div class="container"><div class="row" id="article-body-wrapper"><div class="col-sm-9"><section class="markdownContent markdownContent-headingEnabled js-task-list-container clearfix position-relative" id="item-7e72e98cfe1c8026df2a" itemprop="articleBody"><div class="alert alert-warning"><i class="fa fa-clock-o"></i> More than 1 year has passed since last update.</div><p>型族とかよくわからないから少し勉強した．<br>
※ GHC 7.8.1 から追加された機能を用いています．</p>

<h1>
<span id="直積" class="fragment"></span><a href="#%E7%9B%B4%E7%A9%8D"><i class="fa fa-link"></i></a>直積</h1>

<p>二つの集合 $A$, $B$ に対し，</p>

<div class="code-frame" data-lang="math"><div class="highlight"><pre>
A \times B = \{(a, b) \mid a \in A, b \in B\}
</pre></div></div>

<p>によって定義される集合を直積 (デカルト積，カルテシアン積) という．</p>

<p>例えば $ A = \{ 1, 2 \} $, $ B = \{ a, b, c \} $ とすると<br>
$ A \times B = \{ (1, a), (1, b), (1, c), (2, a), (2, b), (2, c) \}$ となる．要するに，二つの集合から一つずつ要素をとってきて作ったペア (順序対)<sup id="fnref1"><a href="#fn1" rel="footnote" title="順序対では $ (a, b) \neq (b, a) $ である．他に非順序対 $ \{ a, b \} $ があり，こちらは $ \{ a, b \} = \{ b, a \} $">1</a></sup> の集まりである．</p>

<p>ところで Haskell の型は集合と考えられる (<code>Integer</code> は整数の集合，<code>Char</code> は文字の集合とか) ．Haskell には順序対をタプルで表せるから，例えば $ Integer \times Char $ は <code>(Integer, Char)</code> のように表せる．</p>

<p>ということで次のようなことができるはずである．</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="kr">type</span> <span class="n">a</span> <span class="o">&gt;&lt;</span> <span class="n">b</span> <span class="ow">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="nf">test1</span> <span class="ow">::</span> <span class="kt">Integer</span> <span class="o">&gt;&lt;</span> <span class="kt">Char</span>
<span class="nf">test1</span> <span class="ow">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">'a'</span><span class="p">)</span>
</pre></div></div>

<p>しかしこれはコンパイルが通らない．演算子チックな型<sup id="fnref2"><a href="#fn2" rel="footnote" title="型演算子と呼ぶらしい．">2</a></sup>や型シノニムをつくる場合は <code>TypeOperators</code> 拡張が必要である．</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="cm">{-# LANGUAGE TypeOperators #-}</span>

<span class="kr">type</span> <span class="n">a</span> <span class="o">&gt;&lt;</span> <span class="n">b</span> <span class="ow">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="nf">test1</span> <span class="ow">::</span> <span class="kt">Integer</span> <span class="o">&gt;&lt;</span> <span class="kt">Char</span>
<span class="nf">test1</span> <span class="ow">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">'a'</span><span class="p">)</span>

<span class="nf">test2</span> <span class="ow">::</span> <span class="kt">String</span> <span class="o">&gt;&lt;</span> <span class="kt">String</span> <span class="ow">-&gt;</span> <span class="kt">String</span>
<span class="nf">test2</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">=</span> <span class="n">x</span> <span class="o">++</span> <span class="n">y</span>
</pre></div></div>

<h1>
<span id="三つの集合の直積" class="fragment"></span><a href="#%E4%B8%89%E3%81%A4%E3%81%AE%E9%9B%86%E5%90%88%E3%81%AE%E7%9B%B4%E7%A9%8D"><i class="fa fa-link"></i></a>三つの集合の直積</h1>

<p>三つの集合に対しての直積も同様に定義される．</p>

<div class="code-frame" data-lang="math"><div class="highlight"><pre>
A \times B \times C = \{ (a, b, c) \mid a \in A, b \in B, c \in C \}
</pre></div></div>

<p>だがちょっと待ってほしい．二つの集合の直積の定義から考えると， $A \times B$ を先に計算すると</p>

<div class="code-frame" data-lang="math"><div class="highlight"><pre>
(A \times B) \times C = \{ ((a, b), c) \mid a \in A, b \in B, c \in C \}
</pre></div></div>

<p>となり，$B \times C$ を先に計算すると</p>

<div class="code-frame" data-lang="math"><div class="highlight"><pre>
A \times (B \times C) = \{ (a, (b, c)) \mid a \in A, b \in B, c \in C \}
</pre></div></div>

<p>となることが考えられないだろうか．</p>

<p>実際，次のコードはコンパイルを通る．</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="cm">{-# LANGUAGE TypeOperators #-}</span>

<span class="kr">type</span> <span class="n">a</span> <span class="o">&gt;&lt;</span> <span class="n">b</span> <span class="ow">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="nf">test3</span> <span class="ow">::</span> <span class="p">(</span><span class="kt">Integer</span> <span class="o">&gt;&lt;</span> <span class="kt">Char</span><span class="p">)</span> <span class="o">&gt;&lt;</span> <span class="kt">String</span>
<span class="nf">test3</span> <span class="ow">=</span> <span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="n">'a'</span><span class="p">),</span> <span class="s">"Hello"</span><span class="p">)</span>

<span class="nf">test4</span> <span class="ow">::</span> <span class="kt">Integer</span> <span class="o">&gt;&lt;</span> <span class="p">(</span><span class="kt">Char</span> <span class="o">&gt;&lt;</span> <span class="kt">String</span><span class="p">)</span>
<span class="nf">test4</span> <span class="ow">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">'a'</span><span class="p">,</span> <span class="s">"Hello"</span><span class="p">))</span>
</pre></div></div>

<p>また，単に <code>Integer &gt;&lt; Char &gt;&lt; String</code> と書くと <code>(Integer &gt;&lt; Char) &gt;&lt; String</code> のように前から結合されて解釈される．</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="cm">{-# LANGUAGE TypeOperators #-}</span>

<span class="kr">type</span> <span class="n">a</span> <span class="o">&gt;&lt;</span> <span class="n">b</span> <span class="ow">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="nf">test5</span> <span class="ow">::</span> <span class="kt">Integer</span> <span class="o">&gt;&lt;</span> <span class="kt">Char</span> <span class="o">&gt;&lt;</span> <span class="kt">String</span>
<span class="nf">test5</span> <span class="ow">=</span> <span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="n">'a'</span><span class="p">),</span> <span class="s">"Hello"</span><span class="p">)</span>
</pre></div></div>

<p>しかし，集合論では $(a, b, c)$ の定義を $((a, b), c)$ や $(a, (b, c))$ としたり，これらを同一視して扱うことが多い．そのため，</p>

<div class="code-frame" data-lang="math"><div class="highlight"><pre>
A \times B \times C = (A \times B) \times C = A \times (B \times C) =  \{ (a, b, c) \mid a \in A, b \in B, c \in C \}
</pre></div></div>

<p>という定義で問題ない (ということにしておく)．</p>

<p>さて，Haskell でもこの定義に倣って <code>Integer &gt;&lt; Char &gt;&lt; String</code> が <code>(Integer, Char, String)</code> を表すようにしたい．しかし，先ほどの挙動から考えて <code>type</code> でどうにかなりそうな感じではない．そこで，型族 (Type Families) という GHC 拡張を導入する．</p>

<h1>
<span id="型族-type-families" class="fragment"></span><a href="#%E5%9E%8B%E6%97%8F-type-families"><i class="fa fa-link"></i></a>型族 (Type Families)</h1>

<p>型族は，簡単に言うと型レベル函数，つまり型を返す"函数のようなもの"である．</p>

<p>例えば通常の函数は「<code>Int</code> 型の数値をとって 2 倍して返す」とか「<code>Double</code> 型のリストをとって <code>String</code> に変換して返す」とかであるのに対して，型族を使うと「<code>Int</code> 型をとって <code>Double</code> 型を返す」のようなことが出来る．</p>

<h2>
<span id="簡単な例" class="fragment"></span><a href="#%E7%B0%A1%E5%8D%98%E3%81%AA%E4%BE%8B"><i class="fa fa-link"></i></a>簡単な例</h2>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="cm">{-# LANGUAGE TypeFamilies #-}</span>

<span class="kr">type</span> <span class="n">family</span> <span class="kt">Test1</span> <span class="n">t</span> <span class="ow">::</span> <span class="o">*</span>
<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">Test1</span> <span class="kt">Int</span> <span class="ow">=</span> <span class="kt">Double</span>
</pre></div></div>

<p>まず，型族を使うには <code>TypeFamilies</code> 拡張が必要である．</p>

<p>上のコードでは，<code>Test1</code> という型族を定義した．(型族の名前は大文字で始めなければならない．) 一行目の <code>type family Test1 t :: *</code> は，函数における函数宣言のようなもの (型族宣言) であり，二行目の <code>type instance Test1 Int = Double</code> が本体のようなもの (型インスタンス宣言) である．</p>

<p>一行目はとりあえずおいておいて，二行目を見てみると <code>Test1</code> は引数 <code>Int</code> をとり <code>Double</code> を返しているように見える．</p>

<p>実際，次のようなコードが書ける．</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="cm">{-# LANGUAGE TypeFamilies #-}</span>

<span class="kr">type</span> <span class="n">family</span> <span class="kt">Test1</span> <span class="n">t</span> <span class="ow">::</span> <span class="o">*</span>
<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">Test1</span> <span class="kt">Int</span> <span class="ow">=</span> <span class="kt">Double</span>

<span class="nf">test6</span> <span class="ow">::</span> <span class="kt">Double</span>
<span class="nf">test6</span> <span class="ow">=</span> <span class="mf">3.14159</span>

<span class="nf">test7</span> <span class="ow">::</span> <span class="kt">Test1</span> <span class="kt">Int</span>
<span class="nf">test7</span> <span class="ow">=</span> <span class="mf">2.71828</span>

<span class="cm">{- コンパイルエラー</span>
<span class="cm">test8 :: Test1 Char</span>
<span class="cm">test8 = False</span>
<span class="cm">-}</span>
</pre></div></div>

<p><code>Test1</code> 自体は型ではないが，<code>Int</code> をとることで <code>Double</code> という型になっている．<br>
しかしもちろん <code>Test1</code> に <code>Int</code> 以外のものを与えるとエラーとなる．</p>

<p><code>Test1</code> が <code>Char</code> を取ることを許したければ，<code>Test1 Char</code> に対する実装をしてあげればよい．</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="cm">{-# LANGUAGE TypeFamilies #-}</span>

<span class="kr">type</span> <span class="n">family</span> <span class="kt">Test1</span> <span class="n">t</span> <span class="ow">::</span> <span class="o">*</span>
<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">Test1</span> <span class="kt">Int</span> <span class="ow">=</span> <span class="kt">Double</span>
<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">Test1</span> <span class="kt">Char</span> <span class="ow">=</span> <span class="kt">Bool</span>

<span class="nf">test6</span> <span class="ow">::</span> <span class="kt">Double</span>
<span class="nf">test6</span> <span class="ow">=</span> <span class="mf">3.14159</span>

<span class="nf">test7</span> <span class="ow">::</span> <span class="kt">Test1</span> <span class="kt">Int</span>
<span class="nf">test7</span> <span class="ow">=</span> <span class="mf">2.71828</span>

<span class="nf">test8</span> <span class="ow">::</span> <span class="kt">Test1</span> <span class="kt">Char</span>
<span class="nf">test8</span> <span class="ow">=</span> <span class="kt">False</span>
</pre></div></div>

<p>さて，このままでは全くつまらない．例えば思いつくのは，多相的にすることである．</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="cm">{-# LANGUAGE TypeFamilies #-}</span>

<span class="kr">type</span> <span class="n">family</span> <span class="kt">Test2</span> <span class="n">t</span> <span class="ow">::</span> <span class="o">*</span>
<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">Test2</span> <span class="n">a</span> <span class="ow">=</span> <span class="kt">String</span>

<span class="nf">test9</span> <span class="ow">::</span> <span class="kt">Test2</span> <span class="kt">Double</span>
<span class="nf">test9</span> <span class="ow">=</span> <span class="s">"2.71828"</span>

<span class="nf">test10</span> <span class="ow">::</span> <span class="kt">Test2</span> <span class="kt">Char</span>
<span class="nf">test10</span> <span class="ow">=</span> <span class="s">"a"</span>

<span class="nf">test11</span> <span class="ow">::</span> <span class="kt">Test2</span> <span class="p">[</span><span class="kt">Bool</span><span class="p">]</span>
<span class="nf">test11</span> <span class="ow">=</span> <span class="s">"Boolean list."</span>
</pre></div></div>

<p><code>Test2</code> は <code>a</code> という型をとっているが，この <code>a</code> にどんな型でもつっこめるらしいことがわかる．</p>

<p>次のようなこともできる．</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="cm">{-# LANGUAGE TypeFamilies #-}</span>

<span class="kr">type</span> <span class="n">family</span> <span class="kt">Test3</span> <span class="n">t</span> <span class="ow">::</span> <span class="o">*</span>
<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">Test3</span> <span class="n">a</span> <span class="ow">=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>

<span class="nf">test12</span> <span class="ow">::</span> <span class="kt">Test3</span> <span class="kt">Double</span>
<span class="nf">test12</span> <span class="ow">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.3010</span><span class="p">,</span> <span class="mf">0.4771</span><span class="p">,</span> <span class="mf">0.6021</span><span class="p">]</span>

<span class="nf">test13</span> <span class="ow">::</span> <span class="kt">Test3</span> <span class="kt">Char</span>
<span class="nf">test13</span> <span class="ow">=</span> <span class="s">"Hi."</span>
</pre></div></div>

<p>しかし残念ながら，次のようなことはできない．</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="cm">{-# LANGUAGE TypeFamilies #-}</span>

<span class="kr">type</span> <span class="n">family</span> <span class="kt">Test4</span> <span class="n">t</span> <span class="ow">::</span> <span class="o">*</span>
<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">Test4</span> <span class="kt">Int</span> <span class="ow">=</span> <span class="kt">Double</span>
<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">Test4</span> <span class="kt">Char</span> <span class="ow">=</span> <span class="kt">Bool</span>
<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">Test4</span> <span class="n">a</span> <span class="ow">=</span> <span class="n">a</span>
</pre></div></div>

<p>このコードはコンパイルエラーとなる．<br>
これは函数のパターンマッチのようにはいかない．型族のインスタンス宣言では，型引数 ( 上の例だと <code>a</code>) を適当に替えたとき他のインスタンス宣言とぶつかってしまうことがあってはならない<sup id="fnref3"><a href="#fn3" rel="footnote" title="特定の条件を満たしていればそのような重複が許されることがある．参考 → 7.7.2.3. 型シノニムインスタンスの重複">3</a></sup>．(パターンマッチのように，上から順次見ていくということはしない．)</p>

<p>例えば上の例では，<code>type instance Test4 a</code> において <code>a</code> が <code>Int</code> または <code>Char</code> のとき，<code>type instance Test4 Int</code>, <code>type instance Test4 Char</code> と宣言がぶつかってしまうのでダメである．</p>

<p>次のコードも同様の理由でコンパイルエラーとなる．</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="cm">{-# LANGUAGE TypeFamilies #-}</span>

<span class="kr">type</span> <span class="n">family</span> <span class="kt">Test5</span> <span class="n">t</span> <span class="ow">::</span> <span class="o">*</span>
<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">Test5</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">Test5</span> <span class="n">a</span> <span class="ow">=</span> <span class="n">a</span>
</pre></div></div>

<p>しかし，次のコードはコンパイルを通る．<code>a</code> に何を入れても宣言がぶつからないためである．</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="cm">{-# LANGUAGE TypeFamilies #-}</span>

<span class="kr">type</span> <span class="n">family</span> <span class="kt">Test6</span> <span class="n">t</span> <span class="ow">::</span> <span class="o">*</span>
<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">Test6</span> <span class="kt">Int</span> <span class="ow">=</span> <span class="kt">Int</span>
<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">Test6</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="ow">=</span> <span class="n">a</span>
</pre></div></div>

<h2>
<span id="複数の型を受け取る" class="fragment"></span><a href="#%E8%A4%87%E6%95%B0%E3%81%AE%E5%9E%8B%E3%82%92%E5%8F%97%E3%81%91%E5%8F%96%E3%82%8B"><i class="fa fa-link"></i></a>複数の型を受け取る</h2>

<p>今までのコードでは型族は一つしか型を受けとらなかった．しかし，受け取る型の数は一つに限らない．<br>
例えば型を二つ受け取りたい場合次のように記述する．</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="cm">{-# LANGUAGE TypeFamilies #-}</span>

<span class="kr">type</span> <span class="n">family</span> <span class="kt">Test7</span> <span class="n">s</span> <span class="n">t</span> <span class="ow">::</span> <span class="o">*</span>
<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">Test7</span> <span class="kt">Int</span> <span class="kt">Int</span> <span class="ow">=</span> <span class="kt">Int</span>
<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">Test7</span> <span class="kt">Int</span> <span class="kt">Double</span> <span class="ow">=</span> <span class="kt">Char</span>
<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">Test7</span> <span class="kt">Double</span> <span class="n">a</span> <span class="ow">=</span> <span class="kt">Double</span>

<span class="nf">test14</span> <span class="ow">::</span> <span class="kt">Test7</span> <span class="kt">Int</span> <span class="kt">Double</span>
<span class="nf">test14</span> <span class="ow">=</span> <span class="n">'1'</span>

<span class="nf">test15</span> <span class="ow">::</span> <span class="kt">Test7</span> <span class="kt">Double</span> <span class="kt">Int</span>
<span class="nf">test15</span> <span class="ow">=</span> <span class="mf">1.5</span>
</pre></div></div>

<p>さらに多くなっても同様である．</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="cm">{-# LANGUAGE TypeFamilies #-}</span>

<span class="kr">type</span> <span class="n">family</span> <span class="kt">Test8</span> <span class="n">s</span> <span class="n">t</span> <span class="n">u</span> <span class="ow">::</span> <span class="o">*</span>
<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">Test8</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="ow">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="p">[</span><span class="n">c</span><span class="p">])</span>

<span class="nf">test16</span> <span class="ow">::</span> <span class="kt">Test8</span> <span class="kt">Int</span> <span class="kt">Double</span> <span class="kt">Char</span>
<span class="nf">test16</span> <span class="ow">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s">"AH^~ My heart will be hopping^~"</span><span class="p">)</span>
</pre></div></div>

<p>逆に次のように一つも型を受け取らないこともできる．</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="cm">{-# LANGUAGE TypeFamilies #-}</span>

<span class="kr">type</span> <span class="n">family</span> <span class="kt">Test9</span> <span class="ow">::</span> <span class="o">*</span>
<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">Test9</span> <span class="ow">=</span> <span class="kt">Bool</span>

<span class="nf">test17</span> <span class="ow">::</span> <span class="kt">Test9</span> <span class="ow">-&gt;</span> <span class="kt">String</span>
<span class="nf">test17</span> <span class="kt">True</span> <span class="ow">=</span> <span class="s">"Ja."</span>
<span class="nf">test17</span> <span class="kr">_</span>    <span class="ow">=</span> <span class="s">"Nej."</span>
</pre></div></div>

<h2>
<span id="カインド" class="fragment"></span><a href="#%E3%82%AB%E3%82%A4%E3%83%B3%E3%83%89"><i class="fa fa-link"></i></a>カインド</h2>

<p>型族宣言中に登場する <code>*</code> はカインドである．(あとでかく)</p>

<h1>
<span id="閉じた型族-closed-type-families" class="fragment"></span><a href="#%E9%96%89%E3%81%98%E3%81%9F%E5%9E%8B%E6%97%8F-closed-type-families"><i class="fa fa-link"></i></a>閉じた型族 (Closed Type Families)</h1>

<p>型族は函数のようなパターンマッチングはできなかったが，実は閉じた型族 (Closed Type Families) を用いるとパターンマッチングを行うことができる．</p>

<p>Closed Type Families は，<code>type instance</code> の代わりに <code>where</code> を用いて次のように記述する．</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="cm">{-# LANGUAGE TypeFamilies #-}</span>

<span class="kr">type</span> <span class="n">family</span> <span class="kt">Test10</span> <span class="n">t</span> <span class="ow">::</span> <span class="o">*</span> <span class="kr">where</span>
  <span class="kt">Test10</span> <span class="kt">Int</span> <span class="ow">=</span> <span class="kt">Double</span>
  <span class="kt">Test10</span> <span class="kt">Char</span> <span class="ow">=</span> <span class="kt">Bool</span>
  <span class="kt">Test10</span> <span class="n">a</span> <span class="ow">=</span> <span class="n">a</span>

<span class="nf">test18</span> <span class="ow">::</span> <span class="kt">Test10</span> <span class="kt">Int</span>
<span class="nf">test18</span> <span class="ow">=</span> <span class="o">-</span><span class="mi">5</span>

<span class="nf">test19</span> <span class="ow">::</span> <span class="kt">Test10</span> <span class="kt">Char</span>
<span class="nf">test19</span> <span class="ow">=</span> <span class="kt">True</span>

<span class="nf">test20</span> <span class="ow">::</span> <span class="kt">Test10</span> <span class="p">(</span><span class="kt">Maybe</span> <span class="kt">String</span><span class="p">)</span>
<span class="nf">test20</span> <span class="ow">=</span> <span class="kt">Just</span> <span class="s">"Nyaa"</span>
</pre></div></div>

<p>先ほどと異なり，上のコードはコンパイルを通り，想定通り動く．</p>

<p>Closed Type Families では函数のパターンマッチと同様，上から順に合致するパターンを探す．そのため，<code>type instance</code> を用いて記述する場合 (開いた型族, Open Type Families) と比べて少し制約がある．</p>

<p>Open Type Families の場合は，型族のインスタンス宣言 (本体の定義) は離れた場所で行うことができる．極端な例を挙げれば，モジュールをまたがってもよい．</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="cm">{-# LANGUAGE TypeFamilies #-}</span>

<span class="kr">type</span> <span class="n">family</span> <span class="kt">Test11</span> <span class="n">t</span> <span class="ow">::</span> <span class="o">*</span>

<span class="nf">test21</span> <span class="ow">::</span> <span class="kt">Test11</span> <span class="kt">Char</span>
<span class="nf">test21</span> <span class="ow">=</span> <span class="n">getChar</span>

<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">Test11</span> <span class="kt">Int</span> <span class="ow">=</span> <span class="p">[</span><span class="kt">Int</span><span class="p">]</span>

<span class="nf">test22</span> <span class="ow">::</span> <span class="kt">Test11</span> <span class="kt">Double</span>
<span class="nf">test22</span> <span class="ow">=</span> <span class="kt">Nothing</span>

<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">Test11</span> <span class="kt">Double</span> <span class="ow">=</span> <span class="kt">Maybe</span> <span class="kt">Double</span>

<span class="nf">test23</span> <span class="ow">::</span> <span class="kt">Test11</span> <span class="kt">Int</span>
<span class="nf">test23</span> <span class="ow">=</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">100</span><span class="p">]</span>

<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">Test11</span> <span class="kt">Char</span> <span class="ow">=</span> <span class="kt">IO</span> <span class="kt">Char</span>
</pre></div></div>

<p>それに対して，Closed Type Families の場合は型族宣言と本体の定義が同じ場所で行われる必要がある．従って，次のようなコードはコンパイルエラーとなる．</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="cm">{-# LANGUAGE TypeFamilies #-}</span>

<span class="kr">type</span> <span class="n">family</span> <span class="kt">Test12</span> <span class="n">t</span> <span class="ow">::</span> <span class="o">*</span> <span class="kr">where</span>
  <span class="kt">Test12</span> <span class="kt">Char</span> <span class="ow">=</span> <span class="kt">IO</span> <span class="kt">Char</span>

<span class="nf">test24</span> <span class="ow">::</span> <span class="kt">Test12</span> <span class="kt">Char</span>
<span class="nf">test24</span> <span class="ow">=</span> <span class="n">getChar</span>

  <span class="kt">Test12</span> <span class="kt">Int</span> <span class="ow">=</span> <span class="p">[</span><span class="kt">Int</span><span class="p">]</span> <span class="c1">-- コンパイルエラー</span>
</pre></div></div>

<p>また次のように Open と Closed を混ぜるのもダメである．</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="cm">{-# LANGUAGE TypeFamilies #-}</span>

<span class="kr">type</span> <span class="n">family</span> <span class="kt">Test13</span> <span class="n">t</span> <span class="ow">::</span> <span class="o">*</span> <span class="kr">where</span>
  <span class="kt">Test13</span> <span class="kt">Char</span> <span class="ow">=</span> <span class="kt">IO</span> <span class="kt">Char</span>

<span class="nf">test25</span> <span class="ow">::</span> <span class="kt">Test13</span> <span class="kt">Char</span>
<span class="nf">test25</span> <span class="ow">=</span> <span class="n">getChar</span>

<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">Test13</span> <span class="kt">Int</span> <span class="ow">=</span> <span class="p">[</span><span class="kt">Int</span><span class="p">]</span> <span class="c1">-- コンパイルエラー</span>
</pre></div></div>

<h1>
<span id="本題" class="fragment"></span><a href="#%E6%9C%AC%E9%A1%8C"><i class="fa fa-link"></i></a>本題</h1>

<p>では，型族を用いて <code>(&gt;&lt;)</code> を書きなおしてみる．<br>
とりあえず二つの集合の場合のみを考えた実装は次のようになる．</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="cm">{-# LANGUAGE TypeFamilies #-}</span>
<span class="cm">{-# LANGUAGE TypeOperators #-}</span>

<span class="kr">type</span> <span class="n">family</span> <span class="n">s</span> <span class="o">&gt;&lt;</span> <span class="n">t</span> <span class="ow">::</span> <span class="o">*</span> <span class="kr">where</span>
  <span class="n">a</span> <span class="o">&gt;&lt;</span> <span class="n">b</span> <span class="ow">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="nf">test26</span> <span class="ow">::</span> <span class="kt">Integer</span> <span class="o">&gt;&lt;</span> <span class="kt">Char</span>
<span class="nf">test26</span> <span class="ow">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">'a'</span><span class="p">)</span>

<span class="nf">test27</span> <span class="ow">::</span> <span class="kt">String</span> <span class="o">&gt;&lt;</span> <span class="kt">String</span> <span class="ow">-&gt;</span> <span class="kt">String</span>
<span class="nf">test27</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">=</span> <span class="n">x</span> <span class="o">++</span> <span class="n">y</span>
</pre></div></div>

<p>この時点では <code>type</code> を用いた場合とほとんど同じであり，<code>a &gt;&lt; b &gt;&lt; c</code> は <code>((a, b), c)</code> となってしまう．</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="cm">{-# LANGUAGE TypeFamilies #-}</span>
<span class="cm">{-# LANGUAGE TypeOperators #-}</span>

<span class="kr">type</span> <span class="n">family</span> <span class="n">s</span> <span class="o">&gt;&lt;</span> <span class="n">t</span> <span class="ow">::</span> <span class="o">*</span> <span class="kr">where</span>
  <span class="n">a</span> <span class="o">&gt;&lt;</span> <span class="n">b</span> <span class="ow">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="nf">test28</span> <span class="ow">::</span> <span class="kt">Integer</span> <span class="o">&gt;&lt;</span> <span class="kt">Char</span> <span class="o">&gt;&lt;</span> <span class="kt">String</span>
<span class="nf">test28</span> <span class="ow">=</span> <span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="n">'a'</span><span class="p">),</span> <span class="s">"Hello"</span><span class="p">)</span>
</pre></div></div>

<p>そこで，<code>(&gt;&lt;)</code> の定義に次のように加える．</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="cm">{-# LANGUAGE TypeFamilies #-}</span>
<span class="cm">{-# LANGUAGE TypeOperators #-}</span>

<span class="kr">type</span> <span class="n">family</span> <span class="n">s</span> <span class="o">&gt;&lt;</span> <span class="n">t</span> <span class="ow">::</span> <span class="o">*</span> <span class="kr">where</span>
  <span class="n">a</span> <span class="o">&gt;&lt;</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="ow">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
  <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">&gt;&lt;</span> <span class="n">c</span> <span class="ow">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
  <span class="n">a</span> <span class="o">&gt;&lt;</span> <span class="n">b</span> <span class="ow">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div></div>

<p>こうすることにより，$ A \times B \times C = (A \times B) \times C = A \times (B \times C) =  \{ (a, b, c) \mid a \in A, b \in B, c \in C \} $ が実現できる．</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="cm">{-# LANGUAGE TypeFamilies #-}</span>
<span class="cm">{-# LANGUAGE TypeOperators #-}</span>

<span class="kr">type</span> <span class="n">family</span> <span class="n">s</span> <span class="o">&gt;&lt;</span> <span class="n">t</span> <span class="ow">::</span> <span class="o">*</span> <span class="kr">where</span>
  <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">&gt;&lt;</span> <span class="n">c</span> <span class="ow">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
  <span class="n">a</span> <span class="o">&gt;&lt;</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="ow">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
  <span class="n">a</span> <span class="o">&gt;&lt;</span> <span class="n">b</span> <span class="ow">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="nf">test29</span> <span class="ow">::</span> <span class="kt">Integer</span> <span class="o">&gt;&lt;</span> <span class="kt">Char</span> <span class="o">&gt;&lt;</span> <span class="kt">String</span>
<span class="nf">test29</span> <span class="ow">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">'a'</span><span class="p">,</span> <span class="s">"Hello"</span><span class="p">)</span>

<span class="nf">test30</span> <span class="ow">::</span> <span class="p">(</span><span class="kt">Integer</span> <span class="o">&gt;&lt;</span> <span class="kt">Char</span><span class="p">)</span> <span class="o">&gt;&lt;</span> <span class="kt">String</span>
<span class="nf">test30</span> <span class="ow">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">'a'</span><span class="p">,</span> <span class="s">"Hello"</span><span class="p">)</span>

<span class="nf">test31</span> <span class="ow">::</span> <span class="kt">Integer</span> <span class="o">&gt;&lt;</span> <span class="p">(</span><span class="kt">Char</span> <span class="o">&gt;&lt;</span> <span class="kt">String</span><span class="p">)</span>
<span class="nf">test31</span> <span class="ow">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">'a'</span><span class="p">,</span> <span class="s">"Hello"</span><span class="p">)</span>
</pre></div></div>

<p>めでたしめでたし．</p>

<h1>
<span id="n-個の集合の直積" class="fragment"></span><a href="#n-%E5%80%8B%E3%81%AE%E9%9B%86%E5%90%88%E3%81%AE%E7%9B%B4%E7%A9%8D"><i class="fa fa-link"></i></a>n 個の集合の直積</h1>

<p>n 個の集合に対しての直積も同様に定義される．</p>

<div class="code-frame" data-lang="math"><div class="highlight"><pre>
X_1 \times X_2 \times \cdots \times X_n = \{ (x_1, x_2, \cdots , x_n) \mid x_1 \in X_1, x_2 \in X_2, \cdots , x_n \in X_n \}
</pre></div></div>

<p>たとえば 4 個の集合の積に対応するには，<code>(&gt;&lt;)</code> の定義を以下のようにすればよい．</p>

<div class="code-frame" data-lang="hs"><div class="highlight"><pre>
<span class="cm">{-# LANGUAGE TypeFamilies #-}</span>
<span class="cm">{-# LANGUAGE TypeOperators #-}</span>

<span class="kr">type</span> <span class="n">family</span> <span class="n">s</span> <span class="o">&gt;&lt;</span> <span class="n">t</span> <span class="ow">::</span> <span class="o">*</span> <span class="kr">where</span>
  <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">&gt;&lt;</span> <span class="n">d</span> <span class="ow">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
  <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">&gt;&lt;</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="ow">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
  <span class="n">a</span> <span class="o">&gt;&lt;</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="ow">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
  <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">&gt;&lt;</span> <span class="n">c</span> <span class="ow">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
  <span class="n">a</span> <span class="o">&gt;&lt;</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="ow">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
  <span class="n">a</span> <span class="o">&gt;&lt;</span> <span class="n">b</span> <span class="ow">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="nf">test32</span> <span class="ow">::</span> <span class="kt">Integer</span> <span class="o">&gt;&lt;</span> <span class="kt">Char</span> <span class="o">&gt;&lt;</span> <span class="kt">String</span> <span class="o">&gt;&lt;</span> <span class="kt">Bool</span>
<span class="nf">test32</span> <span class="ow">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">'a'</span><span class="p">,</span> <span class="s">"Hello"</span><span class="p">,</span> <span class="kt">True</span><span class="p">)</span>

<span class="nf">test33</span> <span class="ow">::</span> <span class="p">(</span><span class="kt">Integer</span> <span class="o">&gt;&lt;</span> <span class="kt">Char</span><span class="p">)</span> <span class="o">&gt;&lt;</span> <span class="kt">String</span> <span class="o">&gt;&lt;</span> <span class="kt">Bool</span>
<span class="nf">test33</span> <span class="ow">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">'a'</span><span class="p">,</span> <span class="s">"Hello"</span><span class="p">,</span> <span class="kt">True</span><span class="p">)</span>

<span class="nf">test34</span> <span class="ow">::</span> <span class="p">(</span><span class="kt">Integer</span> <span class="o">&gt;&lt;</span> <span class="kt">Char</span> <span class="o">&gt;&lt;</span> <span class="kt">String</span><span class="p">)</span> <span class="o">&gt;&lt;</span> <span class="kt">Bool</span>
<span class="nf">test34</span> <span class="ow">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">'a'</span><span class="p">,</span> <span class="s">"Hello"</span><span class="p">,</span> <span class="kt">True</span><span class="p">)</span>

<span class="nf">test35</span> <span class="ow">::</span> <span class="kt">Integer</span> <span class="o">&gt;&lt;</span> <span class="p">(</span><span class="kt">Char</span> <span class="o">&gt;&lt;</span> <span class="kt">String</span><span class="p">)</span> <span class="o">&gt;&lt;</span> <span class="kt">Bool</span>
<span class="nf">test35</span> <span class="ow">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">'a'</span><span class="p">,</span> <span class="s">"Hello"</span><span class="p">,</span> <span class="kt">True</span><span class="p">)</span>

<span class="nf">test36</span> <span class="ow">::</span> <span class="kt">Integer</span> <span class="o">&gt;&lt;</span> <span class="p">(</span><span class="kt">Char</span> <span class="o">&gt;&lt;</span> <span class="kt">String</span> <span class="o">&gt;&lt;</span> <span class="kt">Bool</span><span class="p">)</span>
<span class="nf">test36</span> <span class="ow">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">'a'</span><span class="p">,</span> <span class="s">"Hello"</span><span class="p">,</span> <span class="kt">True</span><span class="p">)</span>

<span class="nf">test37</span> <span class="ow">::</span> <span class="kt">Integer</span> <span class="o">&gt;&lt;</span> <span class="kt">Char</span> <span class="o">&gt;&lt;</span> <span class="p">(</span><span class="kt">String</span> <span class="o">&gt;&lt;</span> <span class="kt">Bool</span><span class="p">)</span>
<span class="nf">test37</span> <span class="ow">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">'a'</span><span class="p">,</span> <span class="s">"Hello"</span><span class="p">,</span> <span class="kt">True</span><span class="p">)</span>

<span class="nf">test38</span> <span class="ow">::</span> <span class="p">(</span><span class="kt">Integer</span> <span class="o">&gt;&lt;</span> <span class="kt">Char</span><span class="p">)</span> <span class="o">&gt;&lt;</span> <span class="p">(</span><span class="kt">String</span> <span class="o">&gt;&lt;</span> <span class="kt">Bool</span><span class="p">)</span>
<span class="nf">test38</span> <span class="ow">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">'a'</span><span class="p">,</span> <span class="s">"Hello"</span><span class="p">,</span> <span class="kt">True</span><span class="p">)</span>
</pre></div></div>

<h1>
<span id="デカルト冪" class="fragment"></span><a href="#%E3%83%87%E3%82%AB%E3%83%AB%E3%83%88%E5%86%AA"><i class="fa fa-link"></i></a>デカルト冪</h1>

<p>気が向いたら書く</p>

<h1>
<span id="考察" class="fragment"></span><a href="#%E8%80%83%E5%AF%9F"><i class="fa fa-link"></i></a>考察</h1>

<p>今回の実装では掛ける集合の数が増えるほど <code>(&gt;&lt;)</code> の定義を増やさなければならなかった．n 個の直積にジェネリックに対応させることもできるのかもしれないが <del>ここに書くには余白が狭すぎる</del> 勉強不足でそこまではできなかった．(知っている人がいたらコメントでこっそり教えてください &gt;&lt;)</p>

<h1>
<span id="参考" class="fragment"></span><a href="#%E5%8F%82%E8%80%83"><i class="fa fa-link"></i></a>参考</h1>

<p><a href="http://blog.konn-san.com/article/20120606/promoted-types-and-list-arguments" title="GHC 7.4.1 の型レベル新機能を使い倒す 〜GADTs、型族 と DataKinds、ConstraintKinds の円環〜 - これは圏です" rel="nofollow noopener" target="_blank">GHC 7.4.1 の型レベル新機能を使い倒す 〜GADTs、型族 と DataKinds、ConstraintKinds の円環〜 - これは圏です</a><br>
<a href="http://www.kotha.net/ghcguide_ja/7.6.2/type-families.html" title="7.7. 型の族" rel="nofollow noopener" target="_blank">7.7. 型の族</a><br>
<a href="http://ja.wikipedia.org/wiki/%E7%9B%B4%E7%A9%8D%E9%9B%86%E5%90%88" title="直積集合 - Wikipedia" rel="nofollow noopener" target="_blank">直積集合 - Wikipedia</a><br>
<a href="http://www.haskell.org/haskellwiki/GHC/Type_families" title="GHC/Type families - HaskellWiki" rel="nofollow noopener" target="_blank">GHC/Type families - HaskellWiki</a></p>

<p>斎藤 毅 著，「集合と位相」 (東京大学出版会) 2009</p>

<h1>
<span id="注釈" class="fragment"></span><a href="#%E6%B3%A8%E9%87%88"><i class="fa fa-link"></i></a>注釈</h1>

<div class="footnotes">
<hr>
<ol>

<li id="fn1">
<p>順序対では $ (a, b) \neq (b, a) $ である．他に非順序対 $ \{ a, b \} $ があり，こちらは $ \{ a, b \} = \{ b, a \} $ <a href="#fnref1">↩</a></p>
</li>

<li id="fn2">
<p>型演算子と呼ぶらしい． <a href="#fnref2">↩</a></p>
</li>

<li id="fn3">
<p>特定の条件を満たしていればそのような重複が許されることがある．参考 → <a href="http://www.kotha.net/ghcguide_ja/7.6.2/type-families.html#type-family-overlap" title="7.7.2.3. 型シノニムインスタンスの重複" rel="nofollow noopener" target="_blank">7.7.2.3. 型シノニムインスタンスの重複</a> <a href="#fnref3">↩</a></p>
</li>

</ol>
</div>
<div class="hidden"><form class="js-task-list-update" action="/CyLomw/items/7e72e98cfe1c8026df2a" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="_method" value="patch" /><input type="hidden" name="authenticity_token" value="C+2RRfvFQeGMomF2tiD2ybIkx3TmDrLBJZYA3bokGC5lbwodYOt4qnNx1GrG1UiQ0mPjx3HK6DYZSAkmWyoW6A==" /><input type="hidden" name="updated_at_confirmation_in_unixtime" id="updated_at_confirmation_in_unixtime" value="1421891566" class="js-task-list-updated-at" /><textarea name="raw_body" id="raw_body" class="js-task-list-field">
型族とかよくわからないから少し勉強した．
※ GHC 7.8.1 から追加された機能を用いています．

# 直積

二つの集合 $A$, $B$ に対し，

```math
A \times B = \{(a, b) \mid a \in A, b \in B\}
```

によって定義される集合を直積 (デカルト積，カルテシアン積) という．


例えば $ A = \\{ 1, 2 \\} $, $ B = \\{ a, b, c \\} $ とすると
$ A \times B = \\{ (1, a), (1, b), (1, c), (2, a), (2, b), (2, c) \\}$ となる．要するに，二つの集合から一つずつ要素をとってきて作ったペア (順序対)[^1] の集まりである．

ところで Haskell の型は集合と考えられる (`Integer` は整数の集合，`Char` は文字の集合とか) ．Haskell には順序対をタプルで表せるから，例えば $ Integer \times Char $ は `(Integer, Char)` のように表せる．

ということで次のようなことができるはずである．

```hs
type a &gt;&lt; b = (a, b)

test1 :: Integer &gt;&lt; Char
test1 = (10, &#39;a&#39;)
```

しかしこれはコンパイルが通らない．演算子チックな型[^2]や型シノニムをつくる場合は `TypeOperators` 拡張が必要である．

```hs
{-# LANGUAGE TypeOperators #-}

type a &gt;&lt; b = (a, b)

test1 :: Integer &gt;&lt; Char
test1 = (10, &#39;a&#39;)

test2 :: String &gt;&lt; String -&gt; String
test2 (x, y) = x ++ y
```

# 三つの集合の直積

三つの集合に対しての直積も同様に定義される．

```math
A \times B \times C = \{ (a, b, c) \mid a \in A, b \in B, c \in C \}
```

だがちょっと待ってほしい．二つの集合の直積の定義から考えると， $A \times B$ を先に計算すると

```math
(A \times B) \times C = \{ ((a, b), c) \mid a \in A, b \in B, c \in C \}
```

となり，$B \times C$ を先に計算すると

```math
A \times (B \times C) = \{ (a, (b, c)) \mid a \in A, b \in B, c \in C \}
```

となることが考えられないだろうか．

実際，次のコードはコンパイルを通る．

```hs
{-# LANGUAGE TypeOperators #-}

type a &gt;&lt; b = (a, b)

test3 :: (Integer &gt;&lt; Char) &gt;&lt; String
test3 = ((10, &#39;a&#39;), &quot;Hello&quot;)

test4 :: Integer &gt;&lt; (Char &gt;&lt; String)
test4 = (10, (&#39;a&#39;, &quot;Hello&quot;))
```

また，単に `Integer &gt;&lt; Char &gt;&lt; String` と書くと `(Integer &gt;&lt; Char) &gt;&lt; String` のように前から結合されて解釈される．

```hs
{-# LANGUAGE TypeOperators #-}

type a &gt;&lt; b = (a, b)

test5 :: Integer &gt;&lt; Char &gt;&lt; String
test5 = ((10, &#39;a&#39;), &quot;Hello&quot;)
```

しかし，集合論では $(a, b, c)$ の定義を $((a, b), c)$ や $(a, (b, c))$ としたり，これらを同一視して扱うことが多い．そのため，

```math
A \times B \times C = (A \times B) \times C = A \times (B \times C) =  \{ (a, b, c) \mid a \in A, b \in B, c \in C \}
```

という定義で問題ない (ということにしておく)．

さて，Haskell でもこの定義に倣って `Integer &gt;&lt; Char &gt;&lt; String` が `(Integer, Char, String)` を表すようにしたい．しかし，先ほどの挙動から考えて `type` でどうにかなりそうな感じではない．そこで，型族 (Type Families) という GHC 拡張を導入する．

# 型族 (Type Families) 

型族は，簡単に言うと型レベル函数，つまり型を返す&quot;函数のようなもの&quot;である．

例えば通常の函数は「`Int` 型の数値をとって 2 倍して返す」とか「`Double` 型のリストをとって `String` に変換して返す」とかであるのに対して，型族を使うと「`Int` 型をとって `Double` 型を返す」のようなことが出来る．

## 簡単な例

```hs
{-# LANGUAGE TypeFamilies #-}

type family Test1 t :: *
type instance Test1 Int = Double
```

まず，型族を使うには `TypeFamilies` 拡張が必要である．

上のコードでは，`Test1` という型族を定義した．(型族の名前は大文字で始めなければならない．) 一行目の `type family Test1 t :: *` は，函数における函数宣言のようなもの (型族宣言) であり，二行目の `type instance Test1 Int = Double` が本体のようなもの (型インスタンス宣言) である．

一行目はとりあえずおいておいて，二行目を見てみると `Test1` は引数 `Int` をとり `Double` を返しているように見える．

実際，次のようなコードが書ける．

```hs
{-# LANGUAGE TypeFamilies #-}

type family Test1 t :: *
type instance Test1 Int = Double

test6 :: Double
test6 = 3.14159

test7 :: Test1 Int
test7 = 2.71828

{- コンパイルエラー
test8 :: Test1 Char
test8 = False
-}
```

`Test1` 自体は型ではないが，`Int` をとることで `Double` という型になっている．
しかしもちろん `Test1` に `Int` 以外のものを与えるとエラーとなる．

`Test1` が `Char` を取ることを許したければ，`Test1 Char` に対する実装をしてあげればよい．

```hs
{-# LANGUAGE TypeFamilies #-}

type family Test1 t :: *
type instance Test1 Int = Double
type instance Test1 Char = Bool

test6 :: Double
test6 = 3.14159

test7 :: Test1 Int
test7 = 2.71828

test8 :: Test1 Char
test8 = False
```

さて，このままでは全くつまらない．例えば思いつくのは，多相的にすることである．

```hs
{-# LANGUAGE TypeFamilies #-}

type family Test2 t :: *
type instance Test2 a = String

test9 :: Test2 Double
test9 = &quot;2.71828&quot;

test10 :: Test2 Char
test10 = &quot;a&quot;

test11 :: Test2 [Bool]
test11 = &quot;Boolean list.&quot;
```

`Test2` は `a` という型をとっているが，この `a` にどんな型でもつっこめるらしいことがわかる．

次のようなこともできる．

```hs
{-# LANGUAGE TypeFamilies #-}

type family Test3 t :: *
type instance Test3 a = [a]

test12 :: Test3 Double
test12 = [0.0, 0.3010, 0.4771, 0.6021]

test13 :: Test3 Char
test13 = &quot;Hi.&quot;
```

しかし残念ながら，次のようなことはできない．

```hs
{-# LANGUAGE TypeFamilies #-}

type family Test4 t :: *
type instance Test4 Int = Double
type instance Test4 Char = Bool
type instance Test4 a = a
```

このコードはコンパイルエラーとなる．
これは函数のパターンマッチのようにはいかない．型族のインスタンス宣言では，型引数 ( 上の例だと `a`) を適当に替えたとき他のインスタンス宣言とぶつかってしまうことがあってはならない[^3]．(パターンマッチのように，上から順次見ていくということはしない．)

例えば上の例では，`type instance Test4 a` において `a` が `Int` または `Char` のとき，`type instance Test4 Int`, `type instance Test4 Char` と宣言がぶつかってしまうのでダメである．

次のコードも同様の理由でコンパイルエラーとなる．

```hs
{-# LANGUAGE TypeFamilies #-}

type family Test5 t :: *
type instance Test5 (a, a) = [a]
type instance Test5 a = a
```

しかし，次のコードはコンパイルを通る．`a` に何を入れても宣言がぶつからないためである．

```hs
{-# LANGUAGE TypeFamilies #-}

type family Test6 t :: *
type instance Test6 Int = Int
type instance Test6 [a] = a
```

## 複数の型を受け取る

今までのコードでは型族は一つしか型を受けとらなかった．しかし，受け取る型の数は一つに限らない．
例えば型を二つ受け取りたい場合次のように記述する．

```hs
{-# LANGUAGE TypeFamilies #-}

type family Test7 s t :: *
type instance Test7 Int Int = Int
type instance Test7 Int Double = Char
type instance Test7 Double a = Double

test14 :: Test7 Int Double
test14 = &#39;1&#39;

test15 :: Test7 Double Int
test15 = 1.5
```

さらに多くなっても同様である．

```hs
{-# LANGUAGE TypeFamilies #-}

type family Test8 s t u :: *
type instance Test8 a b c = (a, b, [c])

test16 :: Test8 Int Double Char
test16 = (100, 0.5, &quot;AH^~ My heart will be hopping^~&quot;)
```

逆に次のように一つも型を受け取らないこともできる．

```hs
{-# LANGUAGE TypeFamilies #-}

type family Test9 :: *
type instance Test9 = Bool

test17 :: Test9 -&gt; String
test17 True = &quot;Ja.&quot;
test17 _    = &quot;Nej.&quot;
```

## カインド

型族宣言中に登場する `*` はカインドである．(あとでかく)

# 閉じた型族 (Closed Type Families)

型族は函数のようなパターンマッチングはできなかったが，実は閉じた型族 (Closed Type Families) を用いるとパターンマッチングを行うことができる．

Closed Type Families は，`type instance` の代わりに `where` を用いて次のように記述する．

```hs
{-# LANGUAGE TypeFamilies #-}

type family Test10 t :: * where
  Test10 Int = Double
  Test10 Char = Bool
  Test10 a = a

test18 :: Test10 Int
test18 = -5

test19 :: Test10 Char
test19 = True

test20 :: Test10 (Maybe String)
test20 = Just &quot;Nyaa&quot;
```

先ほどと異なり，上のコードはコンパイルを通り，想定通り動く．

Closed Type Families では函数のパターンマッチと同様，上から順に合致するパターンを探す．そのため，`type instance` を用いて記述する場合 (開いた型族, Open Type Families) と比べて少し制約がある．

Open Type Families の場合は，型族のインスタンス宣言 (本体の定義) は離れた場所で行うことができる．極端な例を挙げれば，モジュールをまたがってもよい．

```hs
{-# LANGUAGE TypeFamilies #-}

type family Test11 t :: *

test21 :: Test11 Char
test21 = getChar

type instance Test11 Int = [Int]

test22 :: Test11 Double
test22 = Nothing

type instance Test11 Double = Maybe Double

test23 :: Test11 Int
test23 = [0..100]

type instance Test11 Char = IO Char
```

それに対して，Closed Type Families の場合は型族宣言と本体の定義が同じ場所で行われる必要がある．従って，次のようなコードはコンパイルエラーとなる．

```hs
{-# LANGUAGE TypeFamilies #-}

type family Test12 t :: * where
  Test12 Char = IO Char

test24 :: Test12 Char
test24 = getChar

  Test12 Int = [Int] -- コンパイルエラー
```

また次のように Open と Closed を混ぜるのもダメである．

```hs
{-# LANGUAGE TypeFamilies #-}

type family Test13 t :: * where
  Test13 Char = IO Char

test25 :: Test13 Char
test25 = getChar

type instance Test13 Int = [Int] -- コンパイルエラー
```

# 本題

では，型族を用いて `(&gt;&lt;)` を書きなおしてみる．
とりあえず二つの集合の場合のみを考えた実装は次のようになる．

```hs
{-# LANGUAGE TypeFamilies #-}
{-# LANGUAGE TypeOperators #-}

type family s &gt;&lt; t :: * where
  a &gt;&lt; b = (a, b)
  
test26 :: Integer &gt;&lt; Char
test26 = (10, &#39;a&#39;)

test27 :: String &gt;&lt; String -&gt; String
test27 (x, y) = x ++ y
```

この時点では `type` を用いた場合とほとんど同じであり，`a &gt;&lt; b &gt;&lt; c` は `((a, b), c)` となってしまう．

```hs
{-# LANGUAGE TypeFamilies #-}
{-# LANGUAGE TypeOperators #-}

type family s &gt;&lt; t :: * where
  a &gt;&lt; b = (a, b)

test28 :: Integer &gt;&lt; Char &gt;&lt; String
test28 = ((10, &#39;a&#39;), &quot;Hello&quot;)
```

そこで，`(&gt;&lt;)` の定義に次のように加える．

```hs
{-# LANGUAGE TypeFamilies #-}
{-# LANGUAGE TypeOperators #-}

type family s &gt;&lt; t :: * where
  a &gt;&lt; (b, c) = (a, b, c)
  (a, b) &gt;&lt; c = (a, b, c)
  a &gt;&lt; b = (a, b)
```

こうすることにより，$ A \times B \times C = (A \times B) \times C = A \times (B \times C) =  \\{ (a, b, c) \mid a \in A, b \in B, c \in C \\} $ が実現できる．

```hs
{-# LANGUAGE TypeFamilies #-}
{-# LANGUAGE TypeOperators #-}

type family s &gt;&lt; t :: * where
  (a, b) &gt;&lt; c = (a, b, c)
  a &gt;&lt; (b, c) = (a, b, c)
  a &gt;&lt; b = (a, b)

test29 :: Integer &gt;&lt; Char &gt;&lt; String
test29 = (10, &#39;a&#39;, &quot;Hello&quot;)

test30 :: (Integer &gt;&lt; Char) &gt;&lt; String
test30 = (10, &#39;a&#39;, &quot;Hello&quot;)

test31 :: Integer &gt;&lt; (Char &gt;&lt; String)
test31 = (10, &#39;a&#39;, &quot;Hello&quot;)
```

めでたしめでたし．

# n 個の集合の直積
n 個の集合に対しての直積も同様に定義される．

```math
X_1 \times X_2 \times \cdots \times X_n = \{ (x_1, x_2, \cdots , x_n) \mid x_1 \in X_1, x_2 \in X_2, \cdots , x_n \in X_n \}
```

たとえば 4 個の集合の積に対応するには，`(&gt;&lt;)` の定義を以下のようにすればよい．

```hs
{-# LANGUAGE TypeFamilies #-}
{-# LANGUAGE TypeOperators #-}

type family s &gt;&lt; t :: * where
  (a, b, c) &gt;&lt; d = (a, b, c, d)
  (a, b) &gt;&lt; (c, d) = (a, b, c, d)
  a &gt;&lt; (b, c, d) = (a, b, c, d)
  (a, b) &gt;&lt; c = (a, b, c)
  a &gt;&lt; (b, c) = (a, b, c)
  a &gt;&lt; b = (a, b)

test32 :: Integer &gt;&lt; Char &gt;&lt; String &gt;&lt; Bool
test32 = (10, &#39;a&#39;, &quot;Hello&quot;, True)

test33 :: (Integer &gt;&lt; Char) &gt;&lt; String &gt;&lt; Bool
test33 = (10, &#39;a&#39;, &quot;Hello&quot;, True)

test34 :: (Integer &gt;&lt; Char &gt;&lt; String) &gt;&lt; Bool
test34 = (10, &#39;a&#39;, &quot;Hello&quot;, True)

test35 :: Integer &gt;&lt; (Char &gt;&lt; String) &gt;&lt; Bool
test35 = (10, &#39;a&#39;, &quot;Hello&quot;, True)

test36 :: Integer &gt;&lt; (Char &gt;&lt; String &gt;&lt; Bool)
test36 = (10, &#39;a&#39;, &quot;Hello&quot;, True)

test37 :: Integer &gt;&lt; Char &gt;&lt; (String &gt;&lt; Bool)
test37 = (10, &#39;a&#39;, &quot;Hello&quot;, True)

test38 :: (Integer &gt;&lt; Char) &gt;&lt; (String &gt;&lt; Bool)
test38 = (10, &#39;a&#39;, &quot;Hello&quot;, True)
```

# デカルト冪

気が向いたら書く

# 考察

今回の実装では掛ける集合の数が増えるほど `(&gt;&lt;)` の定義を増やさなければならなかった．n 個の直積にジェネリックに対応させることもできるのかもしれないが ~~ここに書くには余白が狭すぎる~~ 勉強不足でそこまではできなかった．(知っている人がいたらコメントでこっそり教えてください &gt;&lt;)

# 参考
[GHC 7.4.1 の型レベル新機能を使い倒す 〜GADTs、型族 と DataKinds、ConstraintKinds の円環〜 - これは圏です](http://blog.konn-san.com/article/20120606/promoted-types-and-list-arguments &quot;GHC 7.4.1 の型レベル新機能を使い倒す 〜GADTs、型族 と DataKinds、ConstraintKinds の円環〜 - これは圏です&quot;)
[7.7. 型の族](http://www.kotha.net/ghcguide_ja/7.6.2/type-families.html &quot;7.7. 型の族&quot;)
[直積集合 - Wikipedia](http://ja.wikipedia.org/wiki/%E7%9B%B4%E7%A9%8D%E9%9B%86%E5%90%88 &quot;直積集合 - Wikipedia&quot;)
[GHC/Type families - HaskellWiki](http://www.haskell.org/haskellwiki/GHC/Type_families &quot;GHC/Type families - HaskellWiki&quot;)

斎藤 毅 著，「集合と位相」 (東京大学出版会) 2009

# 注釈

[^1]: 順序対では $ (a, b) \neq (b, a) $ である．他に非順序対 $ \\{ a, b \\} $ があり，こちらは $ \\{ a, b \\} = \\{ b, a \\} $
[^2]: 型演算子と呼ぶらしい．
[^3]: 特定の条件を満たしていればそのような重複が許されることがある．参考 → [7.7.2.3. 型シノニムインスタンスの重複](http://www.kotha.net/ghcguide_ja/7.6.2/type-families.html#type-family-overlap &quot;7.7.2.3. 型シノニムインスタンスの重複&quot;)
</textarea><input type="submit" name="commit" value="Save changes" data-disable-with="Save changes" /></form></div></section></div><div class="col-sm-3"><div class="socialButtons"><div class="socialButtons_twitter"><a class="twitter-share-button" data-text="GHC 拡張を使って直積っぽい型の表記とかしてみる by @CyLomw on @Qiita" data-url="http://qiita.com/CyLomw/items/7e72e98cfe1c8026df2a" href="https://twitter.com/share">Tweet</a></div><div class="socialButtons_hatebu"><a class="hatena-bookmark-button" data-hatena-bookmark-layout="simple-balloon" data-hatena-bookmark-title="GHC 拡張を使って直積っぽい型の表記とかしてみる" href="http://b.hatena.ne.jp/entry/http://qiita.com/CyLomw/items/7e72e98cfe1c8026df2a" title="Add to Hatena Bookmark"><img alt="Add to Hatena Bookmark" height="20" src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" style="border: none;" width="20" /></a><script async="async" charset="utf-8" src="https://b.st-hatena.com/js/bookmark_button.js" type="text/javascript"></script></div><div class="socialButtons_googlePlus"><div class="g-plusone" data-href="http://qiita.com/CyLomw/items/7e72e98cfe1c8026df2a" data-size="medium"></div></div><div class="socialButtons_facebook"><div class="fb-like" data-action="like" data-href="http://qiita.com/CyLomw/items/7e72e98cfe1c8026df2a" data-layout="button_count" data-share="false" data-show-faces="false"></div></div><div class="socialButtons_pocket"><a class="pocket-btn" data-lang="en" data-pocket-count="horizontal" data-pocket-label="pocket"></a></div></div><section class="itemsShowAuthorInfo" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><a href="/CyLomw"><img alt="" class="itemsShowAuthorInfo_userIcon" itemprop="image" src="https://qiita-image-store.s3.amazonaws.com/0/64300/profile-images/1473696539" /></a><div class="itemsShowAuthorInfo_profileStats"><strong class="itemsShowAuthorInfo_userName" itemprop="name"><a itemprop="url" href="/CyLomw">CyLomw</a></strong><div class="itemsShowAuthorInfo_contribution"><span class="itemsShowAuthorInfo_count">181</span><span class="itemsShowAuthorInfo_unit">Contribution</span></div><div data-react-class="T.UserFollowButton" data-react-props="{&quot;url_name&quot;:&quot;CyLomw&quot;,&quot;initial_followed_by&quot;:false,&quot;size&quot;:&quot;btn-xs&quot;,&quot;position&quot;:&quot;author-info&quot;}"></div></div><section class="itemsShowAuthorPopularItems"><h5 class="itemsShowAuthorPopularItems_sectionTitle">Popular Posts</h5><ul class="itemsShowAuthorPopularItems_posts list-unstyled"><li itemscope="" itemtype="http://schema.org/Article"> <a itemprop="url" track="click" data-label="AuthorPopularItemsAtSidebar" href="/CyLomw/items/61b247f209a6d49e5017">Haskell 上で簡単なプログラミング言語を作る</a></li><li itemscope="" itemtype="http://schema.org/Article"> <a itemprop="url" track="click" data-label="AuthorPopularItemsAtSidebar" href="/CyLomw/items/a618b7c7326d9abede63">多価関数と Category</a></li><li itemscope="" itemtype="http://schema.org/Article"> <a itemprop="url" track="click" data-label="AuthorPopularItemsAtSidebar" href="/CyLomw/items/82362e2766e10561641a">Haskell でノベルゲームスクリプトのようなものを作る</a></li><li itemscope="" itemtype="http://schema.org/Article"> <a itemprop="url" track="click" data-label="AuthorPopularItemsAtSidebar" href="/CyLomw/items/eb543cff8715e4f441a3">Arrow を理解する (まとめ)</a></li><li itemscope="" itemtype="http://schema.org/Article"> <a itemprop="url" track="click" data-label="AuthorPopularItemsAtSidebar" href="/CyLomw/items/7e72e98cfe1c8026df2a">GHC 拡張を使って直積っぽい型の表記とかしてみる</a></li></ul></section></section><div class="scroll-chaser"><div class="google-adsense"><style>.test-text-responsible { width: 200px; height: 200px; }@media(min-width: 1200px) {  .test-text-responsible { width: 250px; height: 250px; }}@media(max-width: 979px) and (min-width: 768px) {  .test-text-responsible { width: 120px; height: 240px; }}@media(max-width: 767px) {  .test-text-responsible { width: 320px; height: 50px; }}</style><script async="" src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle test-text-responsible" data-ad-client="ca-pub-8127218772604357" data-ad-slot="3880091879" style="display:inline-block"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div><div data-react-class="T.Toc" data-react-props="{&quot;body&quot;:&quot;\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#%E7%9B%B4%E7%A9%8D\&quot;\u003e直積\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#%E4%B8%89%E3%81%A4%E3%81%AE%E9%9B%86%E5%90%88%E3%81%AE%E7%9B%B4%E7%A9%8D\&quot;\u003e三つの集合の直積\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#%E5%9E%8B%E6%97%8F-type-families\&quot;\u003e型族 (Type Families)\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#%E7%B0%A1%E5%8D%98%E3%81%AA%E4%BE%8B\&quot;\u003e簡単な例\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#%E8%A4%87%E6%95%B0%E3%81%AE%E5%9E%8B%E3%82%92%E5%8F%97%E3%81%91%E5%8F%96%E3%82%8B\&quot;\u003e複数の型を受け取る\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#%E3%82%AB%E3%82%A4%E3%83%B3%E3%83%89\&quot;\u003eカインド\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#%E9%96%89%E3%81%98%E3%81%9F%E5%9E%8B%E6%97%8F-closed-type-families\&quot;\u003e閉じた型族 (Closed Type Families)\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#%E6%9C%AC%E9%A1%8C\&quot;\u003e本題\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#n-%E5%80%8B%E3%81%AE%E9%9B%86%E5%90%88%E3%81%AE%E7%9B%B4%E7%A9%8D\&quot;\u003en 個の集合の直積\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#%E3%83%87%E3%82%AB%E3%83%AB%E3%83%88%E5%86%AA\&quot;\u003eデカルト冪\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#%E8%80%83%E5%AF%9F\&quot;\u003e考察\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#%E5%8F%82%E8%80%83\&quot;\u003e参考\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\&quot;#%E6%B3%A8%E9%87%88\&quot;\u003e注釈\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n&quot;,&quot;wrapper&quot;:&quot;#article-body-wrapper&quot;}"></div></div></div><div class="row"><div class="col-sm-9"><div class="ArticleFooter__menu"><div class="s-flex-align-center"><div class="js-likebutton" data-props="{&quot;like_status&quot;:false,&quot;like_count&quot;:17,&quot;show_count&quot;:true,&quot;uuid&quot;:&quot;7e72e98cfe1c8026df2a&quot;,&quot;likable_type&quot;:&quot;Article&quot;,&quot;position&quot;:&quot;article-footer&quot;}"></div><div class="ArticleFooter__userList"><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="HirofumiYashima"><a itemprop="url" href="/HirofumiYashima"><img alt="HirofumiYashima" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/43487/profile-images/1473689546" /></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="skonb"><a itemprop="url" href="/skonb"><img alt="skonb" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/15796/profile-images/1473681688" /></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="JunKikuchi"><a itemprop="url" href="/JunKikuchi"><img alt="JunKikuchi" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/13181/profile-images/1473682708" /></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="ynakayama"><a itemprop="url" href="/ynakayama"><img alt="ynakayama" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/38501/profile-images/1473687793" /></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="7shi"><a itemprop="url" href="/7shi"><img alt="7shi" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/32057/profile-images/1473685823" /></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="wint"><a itemprop="url" href="/wint"><img alt="wint" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/62934/profile-images/1473696116" /></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="techno-tanoC"><a itemprop="url" href="/techno-tanoC"><img alt="techno-tanoC" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/49469/profile-images/1473691739" /></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="ykominami"><a itemprop="url" href="/ykominami"><img alt="ykominami" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/4321/profile-images/1473756115" /></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="gfngfn"><a itemprop="url" href="/gfngfn"><img alt="gfngfn" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/75927/profile-images/1473700310" /></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="yanana"><a itemprop="url" href="/yanana"><img alt="yanana" class="thumb thumb--xs" src="https://qiita-image-store.s3.amazonaws.com/0/15836/profile-images/1473681701" /></a></div></div><div class="ArticleFooter__user"><a href="/CyLomw/items/7e72e98cfe1c8026df2a/likers"><span class="fa fa-ellipsis-h"></span></a></div></div></div><div class="u-flex u-align-center"><div class="ArticleFooter__stock"><div class="js-stockbutton" data-position="footer_menu" data-props="{&quot;stock_status&quot;:false}"></div></div><div class="ArticleFooter__editRequest"><a class="u-link-no-underline" data-toggle="tooltip" title="You can propose improvements about the article to the author 💪" href="/drafts/7e72e98cfe1c8026df2a/edit"><span class="fa fa-send-o fa-lg"></span> <span>Edit request</span></a></div><div class="dropdown ArticleFooter__dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#"><span class="fa fa-ellipsis-h"></span></a><ul class="dropdown-menu dropdown-menu-right"><li><a href="/CyLomw/items/7e72e98cfe1c8026df2a.md"><span class="fa fa-fw fa-file-text-o"></span> Show article as Markdown</a></li><li><a data-target=".js-report-form" data-toggle="modal" href="#"><i class="fa fa-fw fa-flag"></i> Report article</a></li></ul></div></div></div><ul class="references js-referencesView"><li class="references_header"><i class="fa fa-fw fa-link"></i> Linked from these articles</li><li class="references_reference js-reference"><span>Linked from </span><a href="/7shi/items/1ce76bde464b4a55c143#_reference-bdd675eb29e44cd98dbd"><img alt="" width="18" height="18" src="https://qiita-image-store.s3.amazonaws.com/0/32057/profile-images/1473685823" />Haskell 代数的データ型 超入門</a><time class="references_datetime js-dateTimeView" datetime="2015-01-22T02:01:32+00:00">about 2 years ago</time></li><li class="references_reference js-reference"><span>Linked from </span><a href="/shigemk2/items/31f6bdbf4dfebb0b9adc#_reference-78667777c6bc99b03313"><img alt="" width="18" height="18" src="https://qiita-image-store.s3.amazonaws.com/0/9578/profile-images/1473681465" />Scala 代数的データ型 超入門</a><time class="references_datetime js-dateTimeView" datetime="2015-04-11T09:59:09+00:00">almost 2 years ago</time></li></ul><div class="itemsShowBody_articleColumnFooter"><div class="socialButtons"><div class="socialButtons_twitter"><a class="twitter-share-button" data-text="GHC 拡張を使って直積っぽい型の表記とかしてみる by @CyLomw on @Qiita" data-url="http://qiita.com/CyLomw/items/7e72e98cfe1c8026df2a" href="https://twitter.com/share">Tweet</a></div><div class="socialButtons_hatebu"><a class="hatena-bookmark-button" data-hatena-bookmark-layout="simple-balloon" data-hatena-bookmark-title="GHC 拡張を使って直積っぽい型の表記とかしてみる" href="http://b.hatena.ne.jp/entry/http://qiita.com/CyLomw/items/7e72e98cfe1c8026df2a" title="Add to Hatena Bookmark"><img alt="Add to Hatena Bookmark" height="20" src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" style="border: none;" width="20" /></a><script async="async" charset="utf-8" src="https://b.st-hatena.com/js/bookmark_button.js" type="text/javascript"></script></div><div class="socialButtons_googlePlus"><div class="g-plusone" data-href="http://qiita.com/CyLomw/items/7e72e98cfe1c8026df2a" data-size="medium"></div></div><div class="socialButtons_facebook"><div class="fb-like" data-action="like" data-href="http://qiita.com/CyLomw/items/7e72e98cfe1c8026df2a" data-layout="button_count" data-share="false" data-show-faces="false"></div></div><div class="socialButtons_pocket"><a class="pocket-btn" data-lang="en" data-pocket-count="horizontal" data-pocket-label="pocket"></a></div></div></div><div class="itemsShowComment_wrapper" id="comments"><div data-react-class="T.CommentListContainer" data-react-props="{&quot;currentUser&quot;:null,&quot;initialComments&quot;:[{&quot;banned&quot;:false,&quot;body&quot;:&quot;\u003cp\u003eコメントありがとうございます．\u003cbr\u003e\nそもそも Haskell のタプルは (a, (b, c)) ≠ (a, b, c) なので，最初からタプルとは異なるデータ型を定義して使う方がいいのかもしれないですね．\u003c/p\u003e\n&quot;,&quot;created_at&quot;:&quot;2015-01-14T01:08:05+09:00&quot;,&quot;expanded_references&quot;:&quot;&quot;,&quot;id&quot;:144874,&quot;is_team&quot;:false,&quot;item_id&quot;:227855,&quot;item_type&quot;:&quot;PublicDomainArticle&quot;,&quot;item_uuid&quot;:&quot;7e72e98cfe1c8026df2a&quot;,&quot;likable&quot;:false,&quot;liked&quot;:false,&quot;public_likes_count&quot;:0,&quot;raw_body&quot;:&quot;コメントありがとうございます．\nそもそも Haskell のタプルは (a, (b, c)) ≠ (a, b, c) なので，最初からタプルとは異なるデータ型を定義して使う方がいいのかもしれないですね．\n&quot;,&quot;reaction_types&quot;:[{&quot;image_url&quot;:&quot;https://cdn.qiita.com/emoji/twemoji/unicode/1f44d.png&quot;,&quot;name&quot;:&quot;+1&quot;},{&quot;image_url&quot;:&quot;https://cdn.qiita.com/emoji/twemoji/unicode/1f64f.png&quot;,&quot;name&quot;:&quot;pray&quot;},{&quot;image_url&quot;:&quot;https://cdn.qiita.com/emoji/twemoji/unicode/1f389.png&quot;,&quot;name&quot;:&quot;tada&quot;},{&quot;image_url&quot;:&quot;https://cdn.qiita.com/emoji/twemoji/unicode/1f647.png&quot;,&quot;name&quot;:&quot;bow&quot;},{&quot;image_url&quot;:&quot;https://cdn.qiita.com/emoji/twemoji/unicode/1f631.png&quot;,&quot;name&quot;:&quot;scream&quot;},{&quot;image_url&quot;:&quot;https://cdn.qiita.com/emoji/twemoji/unicode/1f440.png&quot;,&quot;name&quot;:&quot;eyes&quot;}],&quot;reactions&quot;:[],&quot;team&quot;:null,&quot;team_membership&quot;:null,&quot;updatable&quot;:false,&quot;url&quot;:&quot;http://qiita.com/CyLomw/items/7e72e98cfe1c8026df2a#comment-1adeba3e16e4e6cb6748&quot;,&quot;user&quot;:{&quot;contribution&quot;:181,&quot;created_at&quot;:&quot;2014-12-27T20:29:27+09:00&quot;,&quot;id&quot;:64300,&quot;is_admin&quot;:false,&quot;profile_image_url&quot;:&quot;https://qiita-image-store.s3.amazonaws.com/0/64300/profile-images/1473696539&quot;,&quot;suspended&quot;:false,&quot;url_name&quot;:&quot;CyLomw&quot;},&quot;uuid&quot;:&quot;1adeba3e16e4e6cb6748&quot;,&quot;via_email&quot;:false}],&quot;monthly_public_image_uploadable_size_limit&quot;:null,&quot;total_uploaded_public_image_size_in_current_month&quot;:null,&quot;item&quot;:{&quot;id&quot;:227855,&quot;uuid&quot;:&quot;7e72e98cfe1c8026df2a&quot;,&quot;suspended&quot;:false,&quot;secret&quot;:false},&quot;owner&quot;:{&quot;url_name&quot;:&quot;CyLomw&quot;},&quot;is_team&quot;:false,&quot;is_project&quot;:false,&quot;logged_in&quot;:false,&quot;polling&quot;:false,&quot;mention_candidates&quot;:[{&quot;id&quot;:64300,&quot;url_name&quot;:&quot;CyLomw&quot;,&quot;profile_image_url&quot;:&quot;https://qiita-image-store.s3.amazonaws.com/0/64300/profile-images/1473696539&quot;}]}">Comments Loading...</div></div></div></div></div></article><div class="js-report-form modal fade reportForm"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button name="button" type="submit" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title">Report article</h4></div><div class="modal-body"><form action="/reports" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="AwyPr4b82RLIEfFQy1FQOkCpim45i6HOaFkCYFSzL91tjhT3HdLgWTfCREy7pO5jIO6u3a5P+zlUhwubtb0hGw==" /><input type="hidden" name="redirect_path" id="redirect_path" value="/CyLomw/items/7e72e98cfe1c8026df2a" /><input type="hidden" name="item_uuid" id="item_uuid" value="7e72e98cfe1c8026df2a" /><p>Help us understand the problem. What is going on with this item?</p><br /><div class="form-group"><ul class="list-unstyled"><li><label><input type="radio" name="report_type" id="report_type_spam" value="spam" required="required" /> It&#39;s spam </label></li><li><label><input type="radio" name="report_type" id="report_type_harassment" value="harassment" required="required" /> It&#39;s abusive or harmful </label></li><li><label><input type="radio" name="report_type" id="report_type_inappropriate_content" value="inappropriate_content" required="required" /> It contains inappropriate content </label></li></ul></div><div class="reportForm_submitButtonContainer"><button name="button" type="submit" class="btn btn-primary reportForm_submitButton"><i class="fa fa-send"></i> Submit</button></div></form></div></div></div></div><script id="js-item" type="application/json">{ "url": "http://qiita.com/CyLomw/items/7e72e98cfe1c8026df2a", "id": 227855, "uuid": "7e72e98cfe1c8026df2a" }</script><script class="js-user" type="application/json">{&quot;id&quot;:64300,&quot;url_name&quot;:&quot;CyLomw&quot;,&quot;profile_image_url&quot;:&quot;https://qiita-image-store.s3.amazonaws.com/0/64300/profile-images/1473696539&quot;}</script><script language="JavaScript" src="//cdn.bigmining.com/private/js/qiita_bigmining.js" type="text/javascript"></script></div><footer class="footer"><div class="footer_inner"><div class="footer_container"><ul class="footer_links-left"><li class="footer_link"><a class="footer_copyright" href="http://increments.co.jp">© 2011-2017 Increments Inc.</a></li><li class="footer_link"><a href="http://qiita.com/terms">Terms</a></li><li class="footer_link"><a href="http://qiita.com/privacy">Privacy</a></li><li class="footer_link"><a href="http://help.qiita.com">Help</a></li><li class="footer_link"><a href="https://increments.zendesk.com/anonymous_requests/new">Contact</a></li></ul><ul class="footer_links-right"><li class="footer_link"><a href="http://qiita.com/about">About</a></li><li class="footer_link"><a href="/users">Users</a></li><li class="footer_link"><a href="/tags">Tags</a></li><li class="footer_link"><a href="http://blog.qiita.com">Blog</a></li><li class="footer_link"><a href="http://qiita.com/api/v2/docs">API</a></li><li class="footer_link"><a href="https://teams.qiita.com/">Team</a></li><li class="footer_link"><a href="http://kobito.qiita.com">Kobito</a></li><li class="footer_link"><a class="js-public-form-feedback-link" data-target=".js-feedback-form" data-toggle="modal" href=""><i class="fa fa-heart"></i> Feedback <i class="fa fa-caret-down"></i></a></li></ul></div></div></footer><div class="js-feedback-form modal fade feedbackForm"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button name="button" type="submit" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title">Feedback</h4></div><div class="modal-body"><form class="js-feedback-form-form" action="/feedbacks" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="OWRTry836PDwnJ3KuEymLMSxYmYxlK1RXynyeDYbsUxX5sj3tBnRuw9PKNbIuRh1pPZG1aZQ96Zj9/uD1xW/ig==" /><input type="hidden" name="redirect_path" id="redirect_path" value="/CyLomw/items/7e72e98cfe1c8026df2a" /><div class="form-group"><textarea name="feedback[message]" id="feedback_message" class="form-control js-feedback-form-text-area" placeholder="Please give us any feedback about Qiita." required="required" rows="5">
</textarea></div><div class="feedbackForm_submitButtonContainer"><button name="button" type="submit" class="btn btn-primary feedbackForm_submitButton"><i class="fa fa-send"></i> Submit</button><p class="feedbackForm_note">We don&#39;t reply to any feedback.<br />If you need help with Qiita, please send a support request from <a href="https://increments.zendesk.com/anonymous_requests/new">here</a>.</p></div><div style="position:fixed;top:-99999px;opacity:0.0001;"><input name="feedback[name]" type="text" /></div></form></div></div></div></div><script>// if (window.mixpanel instanceof Element) {
//   window.mixpanel = [];
// }
// (function(f,b){if(!b.__SV){var a,e,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" ");
// for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=f.createElement("script");a.type="text/javascript";a.async=!0;a.src="//cdn.mxpnl.com/libs/mixpanel-2.2.min.js";e=f.getElementsByTagName("script")[0];e.parentNode.insertBefore(a,e)}})(document,window.mixpanel||[]);</script><script src="http://cdn.qiita.com/assets/public-8c6201a66dc6db6f64a9017391c319bf.min.js"></script><script>
  (function () {
    var script = document.getElementsByTagName('script')[0];
    var load = function (src, id) {
      var el = document.createElement('script');
      el.async = true;
      el.src = src;
      el.id = id;
      script.parentNode.insertBefore(el, script);
    };
      // Optimizely
      load('//cdn.optimizely.com/js/52738645.js', 'optimizely-jssdk');
      // Google Analytics
      window._gaq = window._gaq || [];
      var isCareer = location.hostname.split('.')[0] == 'career';
      if (isCareer) {
        window._gaq.push(['_setAccount', 'UA-24675221-11']);
        window._gaq.push(['_setDomainName', 'qiita.com']);
      } else {
        window._gaq.push(['_setAccount', 'UA-24675221-1']);
      }
      window._gaq.push(['_setCustomVar', 1, 'logged_in', 'false', 2]);
      window._gaq.push(['_trackPageview']);
      var src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      load(src, 'google-analytics-jssdk');
    // Google Analytics - Universal Analytics
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-24675221-12', {
          
        });
        ga('set', 'dimension1', 'false');
        ga('set', 'dimension3', 'false');
      ga('require', 'displayfeatures');
      ga('set', 'forceSSL', true);
      ga('send', 'pageview');
    // Google Tag Manager
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-TBQWPN');
  })();
</script>
</body></html>